(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    276502,       7336]
NotebookOptionsPosition[    262557,       7106]
NotebookOutlinePosition[    262973,       7123]
CellTagsIndexPosition[    262930,       7120]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Exact solution for the motion of spinning particles near spherically \
symmetric compact objects\
\>", "Title",
 CellChangeTimes->{{3.8986837614604063`*^9, 
  3.898683794393318*^9}},ExpressionUUID->"66b2ecea-b430-453a-a3c6-\
cbc44d55d7b9"],

Cell["\<\
In this notebook we go through the computations presented in the paper \
\[OpenCurlyDoubleQuote]Exact solutions for the motion of spinning particles \
near spherically symmetric black holes and exotic compact objects\
\[CloseCurlyDoubleQuote] by Vojt\[EHacek]ch Witzany and Gabriel Andres \
Piovano. The reader should be able to in principle follow almost every step \
of the computation from the paper by examining this notebook. There is one \
step for which Maple was better suited (expression of quadratures in terms of \
Jacobi elliptic integrals), which can be found in an additional Maple \
notebook. This notebook was written by Vojt\[EHacek]ch Witzany and Gabriel \
Andres Piovano.\
\>", "Text",
 CellChangeTimes->{{3.8986837614604063`*^9, 3.898683896056691*^9}, {
  3.898684643883115*^9, 3.898684704519411*^9}, {3.89868516350366*^9, 
  3.898685222247407*^9}},ExpressionUUID->"6c3a4c55-95b0-4a5d-b4c8-\
c61cf681604a"],

Cell[CellGroupData[{

Cell["Setting up Static, spherically symmetric metric ", "Section",
 CellChangeTimes->{{3.896940395886209*^9, 3.896940414707168*^9}, {
  3.8971188588402653`*^9, 
  3.897118867638599*^9}},ExpressionUUID->"e8e02dbe-f151-4993-a0b6-\
8c9a41ec76f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Generic", " ", "formulas", " ", "in", " ", "any", " ", "space"}], "-", 
     "time"}], ",", " ", 
    RowBox[{"self", "-", "explanatory"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InverseMetric", "[", "g_", "]"}], ":=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Inverse", "[", "g", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"First", " ", "index", " ", "up"}], ",", " ", 
     RowBox[{"second", " ", "two", " ", 
      RowBox[{"down", ":"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ChristoffelSymbol", "[", 
     RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "ig", ",", "res"}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", "4"}], ";", 
       RowBox[{"ig", "=", 
        RowBox[{"InverseMetric", "[", "g", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "*", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ig", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s"}], "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"g", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                   RowBox[{"xx", "[", 
                    RowBox[{"[", "s", "]"}], "]"}]}], "]"}]}], "+", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "s"}], "]"}], "]"}], ",", 
                  RowBox[{"xx", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"xx", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"First", " ", "index", " ", "up"}], ",", " ", 
     RowBox[{"rest", " ", 
      RowBox[{"down", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RiemannTensor", "[", 
     RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Chr", ",", "res"}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", "4"}], ";", 
       RowBox[{"Chr", "=", 
        RowBox[{"ChristoffelSymbol", "[", 
         RowBox[{"g", ",", "xx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Chr", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "k", ",", "m"}], "]"}], "]"}], ",", 
             RowBox[{"xx", "[", 
              RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Chr", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
             RowBox[{"xx", "[", 
              RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Chr", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}], "*", 
              RowBox[{"Chr", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k", ",", "m"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Chr", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s", ",", "m"}], "]"}], "]"}], "*", 
              RowBox[{"Chr", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Two", " ", "lower", " ", 
     RowBox[{"indices", ":"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"RicciTensor", "[", 
     RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Rie", ",", "res", ",", "n"}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", "4"}], ";", 
       RowBox[{"Rie", "=", 
        RowBox[{"RiemannTensor", "[", 
         RowBox[{"g", ",", "xx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Rie", "[", 
             RowBox[{"[", 
              RowBox[{"s", ",", "i", ",", "s", ",", "j"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"RicciScalar", "[", 
     RowBox[{"g_", ",", "xx_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ricc", ",", "ig", ",", "res", ",", "n"}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", "4"}], ";", 
       RowBox[{"Ricc", "=", 
        RowBox[{"RicciTensor", "[", 
         RowBox[{"g", ",", "xx"}], "]"}]}], ";", 
       RowBox[{"ig", "=", 
        RowBox[{"InverseMetric", "[", "g", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ig", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "i"}], "]"}], "]"}], " ", 
           RowBox[{"Ricc", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.896940395886209*^9, {3.898683919103199*^9, 3.898683935211522*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"9a203dc2-7d6b-4f01-82bf-5a0438d7999b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Specializing", " ", "to", " ", "static"}], ",", " ", 
    RowBox[{"spherically", " ", "symmetric", " ", 
     RowBox[{"metric", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gtt", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"f", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grr", "=", " ", 
     RowBox[{"h", "[", "r", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fhRule", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"f", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"2", 
            RowBox[{"M", "/", "#"}]}]}], "&"}], ")"}]}], ",", 
       RowBox[{"h", " ", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", 
              RowBox[{"M", "/", "#"}]}]}], ")"}]}], "&"}], " ", ")"}]}]}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "In", " ", "case", " ", "you", " ", "want", " ", "to", " ", "substitute", 
     " ", "Schwarzschild"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Theta]\[Theta]", "=", " ", 
     SuperscriptBox["r", "2"]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Phi]\[Phi]", "=", " ", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xx", "=", 
     RowBox[{"{", 
      RowBox[{"t", ",", "\[Phi]", ",", "r", ",", "\[Theta]"}], "}"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gtt", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "g\[Phi]\[Phi]", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "grr", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "g\[Theta]\[Theta]"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ig", " ", "=", " ", 
     RowBox[{"InverseMetric", "[", "g", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sqrtg", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"-", 
         RowBox[{"Det", "[", "g", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", ">", "0"}], ",", 
         RowBox[{"0", "<", "\[Theta]", "<", "\[Pi]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ChrisSchw", "=", 
     RowBox[{"ChristoffelSymbol", "[", 
      RowBox[{"g", ",", "xx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RiemSchw", " ", "=", " ", 
     RowBox[{"RiemannTensor", "[", 
      RowBox[{"g", ",", "xx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"All", " ", "lower", " ", "indices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Riemd", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RiemSchw", "[", 
           RowBox[{"[", 
            RowBox[{"s", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "s"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.896930294078179*^9, 3.89693050329508*^9}, {
   3.896930553805229*^9, 3.896930593665873*^9}, {3.896931310023983*^9, 
   3.8969313131171494`*^9}, 3.896931612104539*^9, {3.896932001220887*^9, 
   3.896932008585019*^9}, {3.8969323478844976`*^9, 3.896932368322858*^9}, {
   3.8969324027159853`*^9, 3.896932463199173*^9}, {3.896933095861124*^9, 
   3.896933137831069*^9}, {3.896933323966498*^9, 3.896933334353155*^9}, {
   3.89868394186692*^9, 3.8986839643029957`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"cad8aa8e-71c6-4f38-9453-4e14a851686e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Killing vectors", "Section",
 CellChangeTimes->{{3.896940429377676*^9, 
  3.89694044742074*^9}},ExpressionUUID->"8d53d2e3-4d2d-4fb7-9ec8-\
f7636cb4010d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Killing", " ", "vectors", " ", "with", " ", "indices", " ", "up"}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.896930763848486*^9, 3.89693077288186*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"67300c36-f5ac-4153-a131-fb5cf4f192cd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xit", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], 
      RowBox[{"Cot", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xiy", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{"Cot", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xiz", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Lie", " ", "derivative", " ", "of", " ", "metric", " ", "by", " ", "xi"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lxig", "[", "xi_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "xid", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xid", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xi", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"xid", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"xid", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", "-", " ", 
         RowBox[{"2", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ChrisSchw", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
             RowBox[{"xid", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ximunu", "[", "xi_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xid", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xid", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xi", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"g", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Simplify", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"xid", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"xx", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "-", " ", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"xid", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"xx", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Verifying", " ", "Killing", " ", "equation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Lxig", "[", "xit", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Lxig", "[", "xix", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Lxig", "[", "xiy", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Lxig", "[", "xiz", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ximunu", "[", "xit", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ximunu", "[", "xix", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ximunu", "[", "xiy", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ximunu", "[", "xiz", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.89693074886535*^9, 3.896931201347351*^9}, 
   3.896931294344936*^9, {3.896931334935363*^9, 3.8969313844954033`*^9}, {
   3.8969328329789467`*^9, 3.896932990360662*^9}, {3.8969330307644253`*^9, 
   3.896933088846839*^9}, 3.8969349603153677`*^9, 3.896946818745799*^9, {
   3.896947022982506*^9, 3.8969470390165977`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"4b2cc0af-bc5f-49d8-8501-ae5001762b5e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.89868408308902*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"3190f6a8-2df2-40aa-88fc-1b7f8930385e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.898684083113117*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"0dbf1000-713f-4ae5-bd19-c1517979ba60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.8986840831378307`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"ed33f439-fa62-4292-89bc-9ac1868ff5c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.898684083162661*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"87d79013-3d93-4fd5-9e6c-1e936a10a6d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}], "2"], ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.8986840831867933`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"86f9fb4f-5b08-4d82-b5ff-eac0cfa7f8ab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "r", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", "0", ",", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", 
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.8986840832108192`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"4ed70f75-02eb-4e18-8f40-e4f342b8845c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "r", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.898684083237213*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"7fc7360f-4c08-45e5-9f67-cfd44cbe8b33"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"r", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.896931387275691*^9, 3.896931615784917*^9, 3.8969320173632*^9, {
   3.896932873889092*^9, 3.8969329011098223`*^9}, {3.896932949927449*^9, 
   3.896932983199604*^9}, {3.896933053923349*^9, 3.896933065246232*^9}, {
   3.89693314661197*^9, 3.8969331531172943`*^9}, 3.896933345298059*^9, 
   3.8969349612054243`*^9, 3.896935051338669*^9, 3.8969470404047728`*^9, 
   3.897020335306699*^9, 3.897031997513315*^9, 3.897032161476136*^9, 
   3.897112142110279*^9, 3.897112220445435*^9, 3.897555590879108*^9, 
   3.8976345845879908`*^9, 3.897634651856186*^9, 3.897635474692801*^9, 
   3.898590025870207*^9, 3.898656802477743*^9, 3.898664212436535*^9, 
   3.8986840832617197`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"a6537b8b-2dd8-4140-a301-c2db6c28d849"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dynamics of spinning particle", "Section",
 CellChangeTimes->{{3.896940464175743*^9, 
  3.8969404709567633`*^9}},ExpressionUUID->"dedcc5ec-489b-4ef0-aa4b-\
dbb02f42656f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "for", " ", "the", " ", "dynamical", " ", "variables"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xt", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tt", "[", "\[Tau]", "]"}], ",", 
       RowBox[{"\[Phi]t", "[", "\[Tau]", "]"}], ",", 
       RowBox[{"rt", "[", "\[Tau]", "]"}], ",", 
       RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TrRule", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xx", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "->", 
        RowBox[{"xt", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Substitute", " ", "trajectory", " ", "into", " ", "coordinate", " ", 
     "expressions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeTrRule", " ", "=", " ", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "->", 
          RowBox[{"xx", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"xt", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]"}], "]"}], "->", 
          SuperscriptBox["u", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "i", "]"}], "]"}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"St", "[", "\[Tau]", "]"}], "->", 
          SuperscriptBox["s", "t"]}], ",", 
         RowBox[{
          RowBox[{"Sr", "[", "\[Tau]", "]"}], "->", 
          SuperscriptBox["s", "r"]}], ",", 
         RowBox[{
          RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], "->", 
          SuperscriptBox["s", "\[Phi]"]}], ",", 
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
          SuperscriptBox["s", "\[Theta]"]}]}], "}"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
    "Not", " ", "useful", " ", "but", " ", "visually", " ", "nice", " ", 
     "symbolic", " ", "presentation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ucov", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"xt", ",", "\[Tau]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Four", "-", "velocity"}], ",", " ", 
     RowBox[{"indices", " ", "up"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ucon", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ucov", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Four", "-", "velocity"}], ",", " ", 
     RowBox[{"indices", " ", "down"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8969314173609943`*^9, 3.896931846186133*^9}, {
   3.8969319108683243`*^9, 3.896931948957797*^9}, {3.896932038232312*^9, 
   3.896932048467902*^9}, {3.896932093331916*^9, 3.896932149254133*^9}, {
   3.8969323319959497`*^9, 3.896932332304796*^9}, {3.896932495671736*^9, 
   3.8969324970321083`*^9}, {3.896932714929493*^9, 3.896932799338982*^9}, {
   3.8969331815351458`*^9, 3.8969333055790987`*^9}, {3.8969333541505833`*^9, 
   3.896933386409017*^9}, {3.896935723238756*^9, 3.896935768526053*^9}, 
   3.897634580975752*^9, {3.898656430255069*^9, 3.898656453742325*^9}, 
   3.8986568141724787`*^9, {3.898684016253788*^9, 3.898684043004592*^9}, {
   3.8986841195772676`*^9, 3.8986841581941147`*^9}, {3.898684197189333*^9, 
   3.898684372757249*^9}, {3.898684450024403*^9, 3.89868447542845*^9}, {
   3.898684526053136*^9, 3.8986845604547577`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"b6fa96fc-d000-4190-80dc-03fc9501dc95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Svec", " ", "is", " ", "the", " ", "spin", " ", "vector", " ", "and", " ",
     "has", " ", "indices", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Svec", " ", "=", " ", 
     RowBox[{"\[Epsilon]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"St", "[", "\[Tau]", "]"}], ",", 
        RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], ",", 
        RowBox[{"Sr", "[", "\[Tau]", "]"}], ",", 
        RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Spin", " ", "tensor", " ", "in", " ", "terms", " ", "of", " ", "spin", 
      " ", "vector"}], ",", " ", 
     RowBox[{"indices", " ", "up"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Stens", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{" ", "sqrtg"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"LeviCivitaTensor", "[", "4", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], 
            RowBox[{"ucon", "[", 
             RowBox[{"[", "k", "]"}], "]"}], 
            RowBox[{"g", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "m"}], "]"}], "]"}], 
            RowBox[{"Svec", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Stens", "/.", "DeTrRule"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", "->", "1"}], "}"}]}], ")"}], "//", "Simplify"}],
     "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8969314173609943`*^9, 3.896931846186133*^9}, {
   3.8969319108683243`*^9, 3.896931948957797*^9}, {3.896932038232312*^9, 
   3.896932048467902*^9}, {3.896932093331916*^9, 3.896932149254133*^9}, {
   3.8969323319959497`*^9, 3.896932332304796*^9}, {3.896932495671736*^9, 
   3.8969324970321083`*^9}, {3.896932714929493*^9, 3.896932799338982*^9}, {
   3.8969331815351458`*^9, 3.8969333055790987`*^9}, {3.8969333541505833`*^9, 
   3.896933386409017*^9}, {3.896935723238756*^9, 3.896935768526053*^9}, 
   3.897634580975752*^9, {3.898656430255069*^9, 3.898656453742325*^9}, 
   3.8986568141724787`*^9, {3.898684054684731*^9, 3.89868407628555*^9}, {
   3.8986841665667*^9, 3.8986841794543867`*^9}, {3.898684407793787*^9, 
   3.898684432180835*^9}, {3.8986844889710827`*^9, 3.89868450948917*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"cc90965d-ac37-4cd2-827d-80b74fff7db3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s", "\[Theta]"], " ", 
           SuperscriptBox["u", "r"]}], "-", 
          RowBox[{
           SuperscriptBox["s", "r"], " ", 
           SuperscriptBox["u", "\[Theta]"]}]}], ")"}], " ", 
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"h", "[", "r", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s", "\[Phi]"], " ", 
           SuperscriptBox["u", "\[Theta]"]}], "-", 
          RowBox[{
           SuperscriptBox["s", "\[Theta]"], " ", 
           SuperscriptBox["u", "\[Phi]"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["s", "\[Phi]"]}], " ", 
           SuperscriptBox["u", "r"]}], "+", 
          RowBox[{
           SuperscriptBox["s", "r"], " ", 
           SuperscriptBox["u", "\[Phi]"]}]}], ")"}], " ", 
        RowBox[{"h", "[", "r", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["s", "\[Theta]"]}], " ", 
           SuperscriptBox["u", "r"]}], "+", 
          RowBox[{
           SuperscriptBox["s", "r"], " ", 
           SuperscriptBox["u", "\[Theta]"]}]}], ")"}], " ", 
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"h", "[", "r", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["s", "\[Theta]"]}], " ", 
           SuperscriptBox["u", "t"]}], "+", 
          RowBox[{
           SuperscriptBox["s", "t"], " ", 
           SuperscriptBox["u", "\[Theta]"]}]}], ")"}], " ", 
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"f", "[", "r", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["s", "t"]}], " ", 
           SuperscriptBox["u", "r"]}], "+", 
          RowBox[{
           SuperscriptBox["s", "r"], " ", 
           SuperscriptBox["u", "t"]}]}], ")"}], " ", 
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"f", "[", "r", "]"}], " ", 
          RowBox[{"h", "[", "r", "]"}]}]]}], 
       SuperscriptBox["r", "2"]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["s", "\[Phi]"], " ", 
            SuperscriptBox["u", "\[Theta]"]}], "-", 
           RowBox[{
            SuperscriptBox["s", "\[Theta]"], " ", 
            SuperscriptBox["u", "\[Phi]"]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
        SqrtBox[
         RowBox[{
          RowBox[{"f", "[", "r", "]"}], " ", 
          RowBox[{"h", "[", "r", "]"}]}]]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s", "\[Theta]"], " ", 
           SuperscriptBox["u", "t"]}], "-", 
          RowBox[{
           SuperscriptBox["s", "t"], " ", 
           SuperscriptBox["u", "\[Theta]"]}]}], ")"}], " ", 
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"f", "[", "r", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["s", "\[Phi]"]}], " ", 
           SuperscriptBox["u", "t"]}], "+", 
          RowBox[{
           SuperscriptBox["s", "t"], " ", 
           SuperscriptBox["u", "\[Phi]"]}]}], ")"}], " ", 
        RowBox[{"f", "[", "r", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s", "\[Phi]"], " ", 
           SuperscriptBox["u", "r"]}], "-", 
          RowBox[{
           SuperscriptBox["s", "r"], " ", 
           SuperscriptBox["u", "\[Phi]"]}]}], ")"}], " ", 
        RowBox[{"h", "[", "r", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s", "t"], " ", 
           SuperscriptBox["u", "r"]}], "-", 
          RowBox[{
           SuperscriptBox["s", "r"], " ", 
           SuperscriptBox["u", "t"]}]}], ")"}], " ", 
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"f", "[", "r", "]"}], " ", 
          RowBox[{"h", "[", "r", "]"}]}]]}], 
       SuperscriptBox["r", "2"]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s", "\[Phi]"], " ", 
           SuperscriptBox["u", "t"]}], "-", 
          RowBox[{
           SuperscriptBox["s", "t"], " ", 
           SuperscriptBox["u", "\[Phi]"]}]}], ")"}], " ", 
        RowBox[{"f", "[", "r", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.896932045722739*^9, {3.896933268785829*^9, 3.896933306108165*^9}, {
   3.896933348584228*^9, 3.896933357577005*^9}, 3.89693338864781*^9, 
   3.8969336099309072`*^9, 3.896935051481242*^9, 3.896935832524097*^9, 
   3.89702033573158*^9, 3.897031997883338*^9, 3.8970321617267437`*^9, 
   3.8971121424651003`*^9, 3.897112220747271*^9, 3.897555591297689*^9, 
   3.897634585062833*^9, 3.8976346523034687`*^9, 3.897635475143992*^9, 
   3.8985900263215446`*^9, {3.898656768616735*^9, 3.8986568027552*^9}, 
   3.898656861784412*^9, 3.8986642129482403`*^9, {3.898684059240691*^9, 
   3.8986840835041*^9}, {3.898684162343594*^9, 3.898684201517363*^9}, {
   3.898684361020406*^9, 3.8986843814501534`*^9}, {3.898684414525689*^9, 
   3.8986844337770367`*^9}, {3.898684481727833*^9, 3.8986845104548883`*^9}, 
   3.898684564241416*^9},
 CellLabel->
  "Out[265]//MatrixForm=",ExpressionUUID->"46d4a6dc-155c-430b-abb3-\
fc4e176df533"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sanity", " ", 
    RowBox[{"check", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"suOnShell", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["tt", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], " ", "->", " ", 
        SqrtBox[
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"grr", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["rt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}], "2"]}], "-", 
            RowBox[{"g\[Phi]\[Phi]", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["\[Phi]t", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}], "2"]}], " ", 
            "-", 
            RowBox[{"g\[Theta]\[Theta]", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["\[Theta]t", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}], "2"]}]}], 
           "gtt"], " "}]]}], ",", 
       RowBox[{
        RowBox[{"St", "[", "\[Tau]", "]"}], "->", " ", 
        SqrtBox[
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["S", "2"]}], "-", 
            RowBox[{"grr", " ", 
             SuperscriptBox[
              RowBox[{"Sr", "[", "\[Tau]", "]"}], "2"]}], "-", 
            RowBox[{"g\[Phi]\[Phi]", " ", 
             SuperscriptBox[
              RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], "2"]}], " ", "-", 
            RowBox[{"g\[Theta]\[Theta]", " ", 
             SuperscriptBox[
              RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "2"]}]}], "gtt"], 
          " "}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Stens", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "l"}], "]"}], "]"}], 
           RowBox[{"Svec", "[", 
            RowBox[{"[", "l", "]"}], "]"}]}], "/.", "suOnShell"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Stens", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"ucon", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "/.", "suOnShell"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8976347996440573`*^9, 3.897635161980936*^9}, {
  3.897635218506898*^9, 3.897635269003684*^9}, {3.8976353015400248`*^9, 
  3.897635350331506*^9}, {3.8986566887304697`*^9, 3.898656749676649*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"2a4ffba7-bb72-42cb-a23e-fb918cffb3b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8976349056619473`*^9, 3.8976349387641497`*^9}, {
   3.897635158764051*^9, 3.897635175927105*^9}, {3.897635339593762*^9, 
   3.8976353524782457`*^9}, 3.897635477274941*^9, 3.8985900283408747`*^9, 
   3.8986567599266567`*^9, 3.898656802812131*^9, 3.898664213013907*^9, 
   3.898684083572322*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"bb261d7f-edaf-44e8-b850-f117dd64f903"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8976349056619473`*^9, 3.8976349387641497`*^9}, {
   3.897635158764051*^9, 3.897635175927105*^9}, {3.897635339593762*^9, 
   3.8976353524782457`*^9}, 3.897635477274941*^9, 3.8985900283408747`*^9, 
   3.8986567599266567`*^9, 3.898656802812131*^9, 3.898664213013907*^9, 
   3.898684083591619*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"da555b6e-dcf1-4436-af6e-c886fec40277"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Equations", " ", "of", " ", "motion", " ", "in", " ", "the", " ", "form", 
    " ", "of", " ", 
    RowBox[{"substitutions", "/", "rules"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"xEOM", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"ucov", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]"}], "]"}], "->", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ChrisSchw", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
              RowBox[{"ucov", "[", 
               RowBox[{"[", "j", "]"}], "]"}], 
              RowBox[{"ucov", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "-", " ", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RiemSchw", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], 
              RowBox[{"ucov", "[", 
               RowBox[{"[", "j", "]"}], "]"}], 
              RowBox[{"Stens", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}]}], " ", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "/.", 
      "TrRule"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SEOM", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Svec", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "\[Epsilon]"}], ",", 
           "\[Tau]"}], "]"}], "->", " ", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ChrisSchw", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
               RowBox[{"Svec", "[", 
                RowBox[{"[", "j", "]"}], "]"}], 
               RowBox[{"ucov", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "/", 
           "\[Epsilon]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "/.", 
      "TrRule"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8969314173609943`*^9, 3.896931846186133*^9}, {
   3.8969319108683243`*^9, 3.896931948957797*^9}, {3.896932038232312*^9, 
   3.896932041406851*^9}, {3.896933467407468*^9, 3.896933469244429*^9}, {
   3.896933544674555*^9, 3.8969335645388737`*^9}, 3.896933606912093*^9, 
   3.896933666607025*^9, {3.89693370073359*^9, 3.896933793917666*^9}, {
   3.896934378131613*^9, 3.8969344383447638`*^9}, {3.8969345213566723`*^9, 
   3.89693456170076*^9}, {3.896947191553883*^9, 3.89694721316336*^9}, {
   3.8986591594543743`*^9, 3.898659161494543*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"1b963e1d-919a-4ca8-8d6a-bdb5811e76c0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constants of motion", "Section",
 CellChangeTimes->{{3.896940488115079*^9, 
  3.8969404922839003`*^9}},ExpressionUUID->"76946252-83fb-4288-866a-\
371bbe58976e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Constants", " ", "of", " ", "motion"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SpConst", "[", "xi_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ucon", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"xi", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xi", "[", 
               RowBox[{"[", "k", "]"}], "]"}], 
              RowBox[{"g", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "k"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
         RowBox[{"Stens", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Es", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"SpConst", "[", "xit", "]"}]}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}], 
      "&"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Jx", " ", "=", " ", 
    RowBox[{
     RowBox[{"SpConst", "[", "xix", "]"}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}], 
      "&"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Jy", " ", "=", " ", 
    RowBox[{
     RowBox[{"SpConst", "[", "xiy", "]"}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}], 
      "&"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Jz", " ", "=", 
    RowBox[{
     RowBox[{"SpConst", "[", "xiz", "]"}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}], 
      "&"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jv", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Jx", ",", "Jy", ",", "Jz"}], "}"}], "//", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
           RowBox[{
            RowBox[{"h", "[", 
             RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
           RowBox[{
            RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}], 
       "&"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.896934598879077*^9, 3.896934847024322*^9}, {
   3.896934996198616*^9, 3.896935023463715*^9}, {3.896935135177882*^9, 
   3.896935141181439*^9}, {3.8969353947308903`*^9, 3.896935432235372*^9}, {
   3.8969354631887503`*^9, 3.896935482401833*^9}, {3.8969357820320683`*^9, 
   3.8969357970696917`*^9}, {3.896940789152491*^9, 3.896940797702455*^9}, {
   3.897042410253681*^9, 3.8970424124820337`*^9}, {3.8970432351440907`*^9, 
   3.897043237252162*^9}, {3.897043348407268*^9, 3.897043362799342*^9}, 
   3.897112136489996*^9, {3.897635942751834*^9, 3.897635945392706*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"0161c64f-fadd-4408-8797-e23557b25c18"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "r", "]"}], " ", 
   RowBox[{
    SuperscriptBox["tt", "\[Prime]",
     MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{
     SuperscriptBox["f", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{"h", "[", "r", "]"}]}]]}]]}]], "Output",
 CellChangeTimes->{3.896935483024852*^9, 3.8969407982814093`*^9, 
  3.8970203359863367`*^9, 3.897031998107177*^9, 3.897032161785145*^9, 
  3.897042413015847*^9, 3.897043237661097*^9, 3.897043363897003*^9, 
  3.897112142594475*^9, 3.8971122208709373`*^9, 3.897555591480762*^9, 
  3.897634585258608*^9, 3.89763465247544*^9, 3.897635477458123*^9, 
  3.897635946568865*^9, 3.89859002873382*^9, 3.898656803254857*^9, 
  3.898664213496415*^9, 3.898684083975154*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"e8883236-8f33-404b-9edc-ca293f2a5c93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["r", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Theta]t", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]t", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{
        RowBox[{"f", "[", "r", "]"}], " ", 
        RowBox[{"h", "[", "r", "]"}]}]]], 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["rt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["tt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", 
            RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["tt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["tt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Theta]t", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]t", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.896935483024852*^9, 3.8969407982814093`*^9, 
  3.8970203359863367`*^9, 3.897031998107177*^9, 3.897032161785145*^9, 
  3.897042413015847*^9, 3.897043237661097*^9, 3.897043363897003*^9, 
  3.897112142594475*^9, 3.8971122208709373`*^9, 3.897555591480762*^9, 
  3.897634585258608*^9, 3.89763465247544*^9, 3.897635477458123*^9, 
  3.897635946568865*^9, 3.89859002873382*^9, 3.898656803254857*^9, 
  3.898664213496415*^9, 3.898684089798997*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"bd5b16b7-2a20-44b4-8545-d065d1a677d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Theta]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    SqrtBox[
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{"h", "[", "r", "]"}]}]]], 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"f", "[", "r", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"h", "[", "r", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["rt", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
            RowBox[{
             RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["tt", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}]}], " ", 
             RowBox[{
              SuperscriptBox["tt", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Theta]t", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["tt", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.896935483024852*^9, 3.8969407982814093`*^9, 
  3.8970203359863367`*^9, 3.897031998107177*^9, 3.897032161785145*^9, 
  3.897042413015847*^9, 3.897043237661097*^9, 3.897043363897003*^9, 
  3.897112142594475*^9, 3.8971122208709373`*^9, 3.897555591480762*^9, 
  3.897634585258608*^9, 3.89763465247544*^9, 3.897635477458123*^9, 
  3.897635946568865*^9, 3.89859002873382*^9, 3.898656803254857*^9, 
  3.898664213496415*^9, 3.8986840936064167`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"8e67c7db-2c4a-42e1-8dad-079d91a6c4c3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"f", "[", "r", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"h", "[", "r", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["rt", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["tt", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], "+", 
      
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["tt", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Theta]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]}], 
     ")"}]}], 
   SqrtBox[
    RowBox[{
     RowBox[{"f", "[", "r", "]"}], " ", 
     RowBox[{"h", "[", "r", "]"}]}]]], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["\[Phi]t", "\[Prime]",
     MultilineFunction->None], "[", "\[Tau]", "]"}]}]}]], "Output",
 CellChangeTimes->{3.896935483024852*^9, 3.8969407982814093`*^9, 
  3.8970203359863367`*^9, 3.897031998107177*^9, 3.897032161785145*^9, 
  3.897042413015847*^9, 3.897043237661097*^9, 3.897043363897003*^9, 
  3.897112142594475*^9, 3.8971122208709373`*^9, 3.897555591480762*^9, 
  3.897634585258608*^9, 3.89763465247544*^9, 3.897635477458123*^9, 
  3.897635946568865*^9, 3.89859002873382*^9, 3.898656803254857*^9, 
  3.898664213496415*^9, 3.898684094289083*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"31d5c392-086b-4734-a9e5-b4453899a5a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Verify", " ", "that", " ", "constants", " ", "are", " ", "conserved", " ",
     "by", " ", "EOM", " ", "up", " ", "to", " ", "spin", " ", "squared", " ",
     "terms"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Es", "/.", "TrRule"}], ",", "\[Tau]"}], "]"}], "/.", 
         "xEOM"}], "/.", "SEOM"}], "/.", "TrRule"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Jx", "/.", "TrRule"}], ",", "\[Tau]"}], "]"}], "/.", 
         "xEOM"}], "/.", "SEOM"}], "/.", "TrRule"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Jy", "/.", "TrRule"}], ",", "\[Tau]"}], "]"}], "/.", 
         "xEOM"}], "/.", "SEOM"}], "/.", "TrRule"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Jz", "/.", "TrRule"}], ",", "\[Tau]"}], "]"}], "/.", 
         "xEOM"}], "/.", "SEOM"}], "/.", "TrRule"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.896934598879077*^9, 3.896934847024322*^9}, {
  3.896934996198616*^9, 3.896935023463715*^9}, {3.896935135177882*^9, 
  3.896935141181439*^9}, {3.8969353947308903`*^9, 3.896935459371348*^9}, {
  3.896935546102886*^9, 3.896935610294128*^9}, {3.896935663115157*^9, 
  3.896935669589469*^9}, {3.896935801446746*^9, 3.896935811253969*^9}, {
  3.896935848765432*^9, 3.896935885327705*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"2bf91785-eef0-4168-beea-00b0fe02527b"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.896934817871505*^9, 3.896934847971258*^9, {3.89693502920892*^9, 
   3.896935051523539*^9}, 3.896935142528916*^9, 3.896935400507824*^9, {
   3.896935552770275*^9, 3.896935611499619*^9}, 3.896935670396966*^9, {
   3.8969358272036953`*^9, 3.896935872459445*^9}, 3.897020340092498*^9, 
   3.897032001958075*^9, 3.897032161885377*^9, 3.897112153904867*^9, 
   3.897112221449458*^9, 3.897555603928841*^9, 3.897634595502626*^9, 
   3.897634659019681*^9, 3.897635489576812*^9, 3.898590039797245*^9, 
   3.898656815141849*^9, 3.898664226090074*^9, 3.898684095184359*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"d3147e7d-33c2-49a8-903b-6e406fbaf6fd"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.896934817871505*^9, 3.896934847971258*^9, {3.89693502920892*^9, 
   3.896935051523539*^9}, 3.896935142528916*^9, 3.896935400507824*^9, {
   3.896935552770275*^9, 3.896935611499619*^9}, 3.896935670396966*^9, {
   3.8969358272036953`*^9, 3.896935872459445*^9}, 3.897020340092498*^9, 
   3.897032001958075*^9, 3.897032161885377*^9, 3.897112153904867*^9, 
   3.897112221449458*^9, 3.897555603928841*^9, 3.897634595502626*^9, 
   3.897634659019681*^9, 3.897635489576812*^9, 3.898590039797245*^9, 
   3.898656815141849*^9, 3.898664226090074*^9, 3.8986840961777897`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"f8ca3ede-2fc2-44c9-866e-0702ae299289"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.896934817871505*^9, 3.896934847971258*^9, {3.89693502920892*^9, 
   3.896935051523539*^9}, 3.896935142528916*^9, 3.896935400507824*^9, {
   3.896935552770275*^9, 3.896935611499619*^9}, 3.896935670396966*^9, {
   3.8969358272036953`*^9, 3.896935872459445*^9}, 3.897020340092498*^9, 
   3.897032001958075*^9, 3.897032161885377*^9, 3.897112153904867*^9, 
   3.897112221449458*^9, 3.897555603928841*^9, 3.897634595502626*^9, 
   3.897634659019681*^9, 3.897635489576812*^9, 3.898590039797245*^9, 
   3.898656815141849*^9, 3.898664226090074*^9, 3.898684096770653*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"4fee50b7-bd30-4fd4-9c4c-afbf64129d8f"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.896934817871505*^9, 3.896934847971258*^9, {3.89693502920892*^9, 
   3.896935051523539*^9}, 3.896935142528916*^9, 3.896935400507824*^9, {
   3.896935552770275*^9, 3.896935611499619*^9}, 3.896935670396966*^9, {
   3.8969358272036953`*^9, 3.896935872459445*^9}, 3.897020340092498*^9, 
   3.897032001958075*^9, 3.897032161885377*^9, 3.897112153904867*^9, 
   3.897112221449458*^9, 3.897555603928841*^9, 3.897634595502626*^9, 
   3.897634659019681*^9, 3.897635489576812*^9, 3.898590039797245*^9, 
   3.898656815141849*^9, 3.898664226090074*^9, 3.8986840969107647`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"6caaeb04-822b-43f3-98b4-6fab1ebb6474"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "An", " ", "additional", " ", "constant", " ", "is", " ", "associated", 
     " ", "with", " ", "the", " ", "angular"}], "-", 
    RowBox[{"momentum", " ", "vector", " ", "l"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"l", " ", "=", " ", 
     RowBox[{
      RowBox[{"rt", "[", "\[Tau]", "]"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]t", "'"}], "[", "\[Tau]", "]"}]}], "/", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}], "]"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Phi]t", "'"}], "[", "\[Tau]", "]"}]}]}], "}"}]}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "Verify", " ", "parallel", " ", "transport", " ", "of", " ", "l", " ", 
     "vector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ug", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["tt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], ",", 
       RowBox[{
        SuperscriptBox["\[Phi]t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], ",", 
       RowBox[{
        RowBox[{"rt", "'"}], "[", "\[Tau]", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]t", "'"}], "[", "\[Tau]", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"l", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]"}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ChrisSchw", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
               RowBox[{"ug", "[", 
                RowBox[{"[", "j", "]"}], "]"}], 
               RowBox[{"l", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}], "/.",
           "TrRule"}], "/.", "xEOM"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], "/.", "TrRule"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.898658823281313*^9, 3.8986591359939404`*^9}, {
  3.898659175285775*^9, 3.8986591973741293`*^9}, {3.898659238643696*^9, 
  3.898659272507402*^9}, {3.898659380197628*^9, 3.8986594252615557`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"fcb4e0ab-ac66-4209-ae8b-d18caee3d3f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8986594124634027`*^9, 3.8986594285151052`*^9}, 
   3.8986642279262238`*^9, 3.898684096980384*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"0b022ddd-a0f2-4fa2-b8c0-f38055f9cebd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "aligned", " ", "component", " ", "of", " ", "spin"}],
     ",", " ", 
    RowBox[{"denoted", " ", "by", " ", 
     SubscriptBox["s", "\[DoubleVerticalBar]"], " ", "in", " ", "paper"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"spara", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", " ", 
       FractionBox[
        RowBox[{"l", ".", "g", ".", "Svec"}], 
        SqrtBox[
         RowBox[{"l", ".", "g", ".", "l"}]]], ")"}], "/.", "TrRule"}], "//", 
     "Simplify"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Verify", " ", "conservation", " ", "of", " ", 
     SubscriptBox["s", "\[DoubleVerticalBar]"]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"spara", ",", "\[Tau]"}], "]"}], "/.", "xEOM"}], "/.", 
         "SEOM"}], "/.", "TrRule"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.898658823281313*^9, 3.8986591359939404`*^9}, {
  3.898659175285775*^9, 3.8986591973741293`*^9}, {3.898659238643696*^9, 
  3.898659272507402*^9}, {3.898659380197628*^9, 3.898659474308009*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"a8869a9e-aadc-4019-be8d-d658a7d89962"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Epsilon]", " ", 
   SuperscriptBox[
    RowBox[{"rt", "[", "\[Tau]", "]"}], "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}]}], " ", 
      RowBox[{
       SuperscriptBox["\[Theta]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rt", "[", "\[Tau]", "]"}], "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]t", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]t", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], "2"]}]}], 
     ")"}]}]]]], "Output",
 CellChangeTimes->{{3.898658972572579*^9, 3.89865898391442*^9}, {
   3.8986590191426373`*^9, 3.898659137240917*^9}, {3.898659389510161*^9, 
   3.898659403084126*^9}, 3.898659477133979*^9, 3.898664227981674*^9, 
   3.898684097027926*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"6c285c3b-ce77-4493-9cea-82a773ca270f"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.898658972572579*^9, 3.89865898391442*^9}, {
   3.8986590191426373`*^9, 3.898659137240917*^9}, {3.898659389510161*^9, 
   3.898659403084126*^9}, 3.898659477133979*^9, 3.898664227981674*^9, 
   3.8986840971659603`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"7a08d139-ef5e-4743-993d-00345a366fd7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rotating into aligned plane", "Section",
 CellChangeTimes->{{3.8985954942086477`*^9, 
  3.898595504765497*^9}},ExpressionUUID->"25265eec-160b-47d9-8387-\
8cfa0ab0414f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Defining", " ", "quantitities", " ", "such", " ", "as", " ", "cos", 
     RowBox[{"(", "\[Iota]", ")"}]}], ",", " ", 
    RowBox[{"sin", 
     RowBox[{"(", "\[Iota]", ")"}]}], ",", " ", "\[ScriptCapitalJ]", ",", 
    "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Note", " ", "that", " ", "the", " ", "values", " ", "of", " ", 
     SubscriptBox["\[ScriptCapitalJ]", "x"], " ", "etc", " ", "do", " ", 
     "not", " ", "need", " ", "to", " ", "be", " ", "substituted", " ", 
     "explicitly"}], ",", " ", 
    RowBox[{
    "since", " ", "the", " ", "formulas", " ", "apply", " ", "in", " ", 
     "general"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ci", " ", "=", " ", 
     RowBox[{"JJz", "/", "JJ"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"si", " ", "=", 
     SqrtBox[
      RowBox[{"1", " ", "-", " ", 
       SuperscriptBox["ci", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JJ", " ", "=", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["JJx", "2"], "+", 
       SuperscriptBox["JJy", "2"], "+", 
       SuperscriptBox["JJz", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"JJ", " ", "si"}]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "JJy"}], ",", "JJx", ",", "0"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Align", "[", "v_", "]"}], ":=", 
     RowBox[{
      RowBox[{"n", 
       RowBox[{"(", 
        RowBox[{"n", ".", "v"}], ")"}]}], " ", "+", " ", 
      RowBox[{"ci", 
       RowBox[{"(", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"n", ",", "v"}], "]"}], ",", "n"}], "]"}], ")"}]}], " ", 
      "-", " ", 
      RowBox[{"si", 
       RowBox[{"(", 
        RowBox[{"Cross", "[", 
         RowBox[{"n", ",", "v"}], "]"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BackAlign", "[", "v_", "]"}], ":=", 
     RowBox[{
      RowBox[{"n", 
       RowBox[{"(", 
        RowBox[{"n", ".", "v"}], ")"}]}], " ", "+", " ", 
      RowBox[{"ci", 
       RowBox[{"(", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"n", ",", "v"}], "]"}], ",", "n"}], "]"}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{"si", 
       RowBox[{"(", 
        RowBox[{"Cross", "[", 
         RowBox[{"n", ",", "v"}], "]"}], ")"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8985954942086477`*^9, 3.8985955061418*^9}, {
  3.898595545372663*^9, 3.8985955633156424`*^9}, {3.898596047668797*^9, 
  3.898596169103059*^9}, {3.898596220923689*^9, 3.898596321735456*^9}, {
  3.89859645693365*^9, 3.898596460519618*^9}, {3.898597398074711*^9, 
  3.8985974122331*^9}, {3.898656924444478*^9, 3.898657012438146*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"b199a1f3-334c-4542-9498-849a96567973"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "that", " ", "alignment", " ", "works"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Jalign", " ", "=", " ", 
    RowBox[{
     RowBox[{"Align", "[", 
      RowBox[{"{", 
       RowBox[{"JJx", ",", "JJy", ",", "JJz"}], "}"}], "]"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Check", " ", "that", " ", "inverse", " ", "transofrm", " ", "works"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BackAlign", "[", "Jalign", "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8985954942086477`*^9, 3.8985955061418*^9}, {
  3.898595545372663*^9, 3.8985955633156424`*^9}, {3.898596047668797*^9, 
  3.898596169103059*^9}, {3.898596220923689*^9, 3.898596347842802*^9}, {
  3.898597427953835*^9, 3.89859744279001*^9}, {3.898657021368763*^9, 
  3.898657046365394*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"03d94bc0-f308-44d6-90f6-f33bfa8dea34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["JJx", "2"], "+", 
     SuperscriptBox["JJy", "2"], "+", 
     SuperscriptBox["JJz", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.898596335556787*^9, 3.89859634818575*^9}, 
   3.8985964640928917`*^9, 3.898597443149604*^9, 3.898656815299827*^9, 
   3.898664228191395*^9, 3.898684097215678*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"e51dfb1f-d9c7-4467-b56e-35f44a249e2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"JJx", ",", "JJy", ",", "JJz"}], "}"}]], "Output",
 CellChangeTimes->{{3.898596335556787*^9, 3.89859634818575*^9}, 
   3.8985964640928917`*^9, 3.898597443149604*^9, 3.898656815299827*^9, 
   3.898664228191395*^9, 3.898684097234961*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"a9628717-6642-45d7-93d5-abe9aa0099ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Unit", " ", "position", " ", "vectors", " ", "transformed", " ", "there", 
    " ", "and", " ", "back"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}], "=", 
    RowBox[{
     RowBox[{"Align", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], "]"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xh", ",", "yh", ",", "zh"}], "}"}], "=", 
    RowBox[{
     RowBox[{"BackAlign", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], 
         RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}]}], "}"}], "]"}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.898596925922181*^9, 3.898597003281492*^9}, {
  3.898597558514565*^9, 3.89859759921793*^9}, {3.898655293521556*^9, 
  3.898655315700107*^9}, {3.898657052107205*^9, 3.8986570705996513`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"e68e003f-5313-4947-ba46-93bcafd0a18b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "JJx"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["JJx", "2"], "+", 
         SuperscriptBox["JJy", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"JJx", " ", "JJy", " ", 
          RowBox[{"(", 
           RowBox[{"JJz", "-", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["JJx", "2"], "+", 
              SuperscriptBox["JJy", "2"], "+", 
              SuperscriptBox["JJz", "2"]}]]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["JJx", "2"], " ", "JJz"}], "+", 
            RowBox[{
             SuperscriptBox["JJy", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["JJx", "2"], "+", 
               SuperscriptBox["JJy", "2"], "+", 
               SuperscriptBox["JJz", "2"]}]]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"], "+", 
        SuperscriptBox["JJz", "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "JJy"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["JJx", "2"], "+", 
         SuperscriptBox["JJy", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["JJy", "2"], " ", "JJz"}], "+", 
            RowBox[{
             SuperscriptBox["JJx", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["JJx", "2"], "+", 
               SuperscriptBox["JJy", "2"], "+", 
               SuperscriptBox["JJz", "2"]}]]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{"JJx", " ", "JJy", " ", 
          RowBox[{"(", 
           RowBox[{"JJz", "-", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["JJx", "2"], "+", 
              SuperscriptBox["JJy", "2"], "+", 
              SuperscriptBox["JJz", "2"]}]]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"], "+", 
        SuperscriptBox["JJz", "2"]}]]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"JJz", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"JJy", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
        RowBox[{"JJx", " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["JJx", "2"], "+", 
      SuperscriptBox["JJy", "2"], "+", 
      SuperscriptBox["JJz", "2"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{3.898597632772993*^9, 3.8986553173350353`*^9, 
  3.898656816444828*^9, 3.898664229340156*^9, 3.8986840982950287`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"c541e077-7a46-40f5-af21-6de3118976ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"JJx", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["JJx", "2"], "+", 
         SuperscriptBox["JJy", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"JJx", " ", "JJy", " ", 
          RowBox[{"(", 
           RowBox[{"JJz", "-", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["JJx", "2"], "+", 
              SuperscriptBox["JJy", "2"], "+", 
              SuperscriptBox["JJz", "2"]}]]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["JJx", "2"], " ", "JJz"}], "+", 
            RowBox[{
             SuperscriptBox["JJy", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["JJx", "2"], "+", 
               SuperscriptBox["JJy", "2"], "+", 
               SuperscriptBox["JJz", "2"]}]]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"], "+", 
        SuperscriptBox["JJz", "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"JJy", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["JJx", "2"], "+", 
         SuperscriptBox["JJy", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["JJy", "2"], " ", "JJz"}], "+", 
            RowBox[{
             SuperscriptBox["JJx", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["JJx", "2"], "+", 
               SuperscriptBox["JJy", "2"], "+", 
               SuperscriptBox["JJz", "2"]}]]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "+", 
         RowBox[{"JJx", " ", "JJy", " ", 
          RowBox[{"(", 
           RowBox[{"JJz", "-", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["JJx", "2"], "+", 
              SuperscriptBox["JJy", "2"], "+", 
              SuperscriptBox["JJz", "2"]}]]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["JJx", "2"], "+", 
        SuperscriptBox["JJy", "2"], "+", 
        SuperscriptBox["JJz", "2"]}]]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"JJz", " ", 
      RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"JJy", " ", 
         RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "+", 
        RowBox[{"JJx", " ", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["JJx", "2"], "+", 
      SuperscriptBox["JJy", "2"], "+", 
      SuperscriptBox["JJz", "2"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{3.898597632772993*^9, 3.8986553173350353`*^9, 
  3.898656816444828*^9, 3.898664229340156*^9, 3.8986840992719593`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"5324b390-db33-44f8-a608-9e2ad10d9e26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Forward", " ", "transform"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cos", 
     RowBox[{"(", "\[Theta]", ")"}]}], ":"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"zp", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tan", 
      RowBox[{"(", "\[Phi]", ")"}]}], ":"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xp", "/", "zp"}], "//", "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.898597013675419*^9, 3.898597055076755*^9}, {
   3.8985971111770983`*^9, 3.898597111894224*^9}, {3.898597640918729*^9, 
   3.898597654252049*^9}, {3.898598894843524*^9, 3.898599084585779*^9}, {
   3.898599331231292*^9, 3.898599339416079*^9}, 3.898600289259787*^9, {
   3.8986562752741833`*^9, 3.898656331587476*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"d776cc5b-660e-426f-88c2-532899eee5a2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"JJz", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"JJy", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
      RowBox[{"JJx", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["JJx", "2"], "+", 
    SuperscriptBox["JJy", "2"], "+", 
    SuperscriptBox["JJz", "2"]}]]]], "Output",
 CellChangeTimes->{3.898656271320169*^9, 3.898656817559815*^9, 
  3.898664230458048*^9, 3.898684099330076*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"e24ec77a-a50c-4853-952d-15589ec6e618"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "JJx"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["JJx", "2"], "+", 
       SuperscriptBox["JJy", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"JJx", " ", "JJy", " ", 
        RowBox[{"(", 
         RowBox[{"JJz", "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["JJx", "2"], "+", 
            SuperscriptBox["JJy", "2"], "+", 
            SuperscriptBox["JJz", "2"]}]]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["JJx", "2"], " ", "JJz"}], "+", 
          RowBox[{
           SuperscriptBox["JJy", "2"], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["JJx", "2"], "+", 
             SuperscriptBox["JJy", "2"], "+", 
             SuperscriptBox["JJz", "2"]}]]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["JJx", "2"], "+", 
      SuperscriptBox["JJy", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"JJz", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"JJy", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{"JJx", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.898656271320169*^9, 3.898656817559815*^9, 
  3.898664230458048*^9, 3.898684099522108*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"8fd415bb-4ecb-44e6-97f4-cd006cd9cacd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Inverse", " ", "transform"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cos", 
     RowBox[{"(", "\[CurlyTheta]", ")"}]}], ":"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"zh", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"JJx", " ", "->", " ", 
             RowBox[{
              RowBox[{"Sin", "[", "\[Xi]", "]"}], 
              RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ",", 
            RowBox[{"JJy", " ", "->", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Xi]", "]"}], 
              RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ",", 
            RowBox[{"JJz", " ", "->", " ", 
             RowBox[{"Cos", "[", "\[Iota]", "]"}]}]}], "}"}]}], ")"}], "//", 
        "FullSimplify"}], "//", "TrigReduce"}], "//", "FullSimplify"}], "//", 
     "TrigReduce"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tan", 
      RowBox[{"(", "\[CurlyPhi]", ")"}]}], ":"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"t\[CurlyPhi]", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"xh", "/", "yh"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"JJx", " ", "->", " ", 
                RowBox[{
                 RowBox[{"Sin", "[", "\[Xi]", "]"}], 
                 RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ",", 
               RowBox[{"JJy", " ", "->", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Xi]", "]"}], 
                 RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ",", 
               RowBox[{"JJz", " ", "->", " ", 
                RowBox[{"Cos", "[", "\[Iota]", "]"}]}]}], "}"}]}], ")"}], "//",
            "FullSimplify"}], "//", "TrigReduce"}], "//", "Simplify"}], "//", 
        "TrigReduce"}], "//", "FullSimplify"}], "//", "ExpandAll"}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.898597013675419*^9, 3.898597055076755*^9}, {
   3.8985971111770983`*^9, 3.898597111894224*^9}, {3.898597640918729*^9, 
   3.898597654252049*^9}, {3.898598894843524*^9, 3.898599084585779*^9}, {
   3.898599331231292*^9, 3.898599339416079*^9}, 3.898600289259787*^9, {
   3.89865533410618*^9, 3.898655337752283*^9}, {3.89865536949732*^9, 
   3.898655374427074*^9}, {3.898655424491172*^9, 3.898655597286353*^9}, {
   3.898655637514399*^9, 3.898655669422608*^9}, {3.8986557588380823`*^9, 
   3.898655762609251*^9}, {3.898656340795998*^9, 3.898656365968205*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"81b38675-dced-494b-ae73-0a6bf423cefc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Iota]", "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Xi]", "-", "\[CurlyPhi]"}], "]"}], " ", 
   RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.898599056699061*^9, 3.898599085128553*^9}, 
   3.898600290910658*^9, {3.8986553214906*^9, 3.8986553381686087`*^9}, 
   3.8986553751739063`*^9, {3.898655428269526*^9, 3.898655597700157*^9}, {
   3.898655640925544*^9, 3.898655669875532*^9}, 3.8986557632932863`*^9, 
   3.898656817917997*^9, 3.898664230801214*^9, 3.898684099595326*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"91ae2dfb-14fa-4212-9d86-559292193439"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Iota]", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]", "-", "\[CurlyPhi]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[Xi]", "]"}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"Cos", "[", "\[Xi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Xi]", "-", "\[CurlyPhi]"}], "]"}]}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "\[Iota]", "]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "\[Xi]"}], "-", "\[CurlyPhi]"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox["\[Iota]", "2"], "]"}], "2"], " ", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Xi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Iota]", "]"}]}]}]]], "Output",
 CellChangeTimes->{{3.898599056699061*^9, 3.898599085128553*^9}, 
   3.898600290910658*^9, {3.8986553214906*^9, 3.8986553381686087`*^9}, 
   3.8986553751739063`*^9, {3.898655428269526*^9, 3.898655597700157*^9}, {
   3.898655640925544*^9, 3.898655669875532*^9}, 3.8986557632932863`*^9, 
   3.898656817917997*^9, 3.898664230801214*^9, 3.89868410219073*^9},
 CellLabel->
  "Out[137]=",ExpressionUUID->"a7dd5598-d801-452a-aa2a-f8fb5719704c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "More", " ", "elegant", " ", "expression", " ", "for", " ", "tan", 
    RowBox[{"(", "\[CurlyPhi]", ")"}]}], ":"}], "*)"}]], "Input",
 CellChangeTimes->{{3.898656237364944*^9, 3.898656263886826*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"08de6e5f-c8df-4cf1-938c-cee6cf5ff126"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"t\[CurlyPhi]", " ", "-", " ", 
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}], 
        RowBox[{"Sin", "[", "\[Iota]", "]"}], 
        RowBox[{"Sin", "[", "\[Xi]", "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"\[Iota]", "/", "2"}], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], " ", "-", " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"\[Iota]", "/", "2"}], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"2", "\[Xi]"}], " ", "-", " ", "\[CurlyPhi]"}], 
            "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyTheta]", "]"}], 
        RowBox[{"Sin", "[", "\[Iota]", "]"}], 
        RowBox[{"Cos", "[", "\[Xi]", "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CurlyTheta]", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"\[Iota]", "/", "2"}], "]"}], "2"], " ", 
           RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], " ", "-", " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"\[Iota]", "/", "2"}], "]"}], "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"2", "\[Xi]"}], " ", "-", " ", "\[CurlyPhi]"}], 
            "]"}]}]}], ")"}]}]}]], ")"}]}], "//", "FullSimplify"}]}]], "Input",\

 CellChangeTimes->{
  3.8985972400973597`*^9, {3.8986557679243107`*^9, 3.8986557708447866`*^9}, {
   3.898655870187248*^9, 3.8986560077967176`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"5518958b-e634-43a9-b546-5854f3aef5e2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8986560032436743`*^9, 3.898656008265255*^9}, 
   3.898656820766967*^9, 3.8986642332514*^9, 3.898684102355311*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"552109d8-4796-48ec-9568-3160c7942b31"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving for \[CurlyTheta] in aligned coordinates", "Section",
 CellChangeTimes->{{3.896940503611871*^9, 3.896940510683374*^9}, {
  3.898595472402727*^9, 
  3.8985954880885057`*^9}},ExpressionUUID->"7685156a-9502-485e-bc19-\
7a12603fe77f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "the", " ", "constraints", " ", "following", " ", "from", " ", 
    "rotating", " ", "the", " ", "coordinate", " ", "system", " ", "into", 
    " ", "J"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jx", "/.", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", "->", 
          RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]t", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], ")"}]}],
         "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jy", "/.", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", "->", 
          RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]t", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Pi]", "/", "2"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], ")"}]}],
         "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.896935205859728*^9, 3.896935246374448*^9}, {
  3.896935922455879*^9, 3.896935937427124*^9}, {3.896937566096096*^9, 
  3.896937746365444*^9}, {3.8969377965582533`*^9, 3.896937820885103*^9}, {
  3.896938040125537*^9, 3.896938055768371*^9}, {3.896938518424436*^9, 
  3.896938543861743*^9}, {3.8969387272860327`*^9, 3.896938730312518*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"58ec0087-6d37-430e-98cf-746c3983c5d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["\[Delta]\[Theta]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"\[Delta]\[Theta]t", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], "+", 
      
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", "r", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"h", "[", "r", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["rt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
             RowBox[{
              RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["tt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"r", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["tt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
             RowBox[{
              RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["\[Phi]t", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]}],
          ")"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]]}], ")"}], " ", "\[Epsilon]"}], "+", 
   
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {$CellContext`r^2 (-Sin[$CellContext`\[Phi]] 
       Derivative[1][$CellContext`\[Delta]\[Theta]t][$CellContext`\[Tau]] + 
      Cos[$CellContext`\[Phi]] $CellContext`\[Delta]\[Theta]t[$CellContext`\
\[Tau]] Derivative[
        1][$CellContext`\[Phi]t][$CellContext`\[Tau]]) + \
$CellContext`f[$CellContext`r] ($CellContext`f[$CellContext`r] \
$CellContext`h[$CellContext`r])^Rational[-1, 2] (
      Cos[$CellContext`\[Phi]] $CellContext`h[$CellContext`r] \
($CellContext`St[$CellContext`\[Tau]] 
         Derivative[
          1][$CellContext`rt][$CellContext`\[Tau]] - \
$CellContext`Sr[$CellContext`\[Tau]] 
        Derivative[1][$CellContext`tt][$CellContext`\[Tau]]) + $CellContext`r 
       Sin[$CellContext`\[Phi]] ($CellContext`S\[Phi][$CellContext`\[Tau]] 
         Derivative[
          1][$CellContext`tt][$CellContext`\[Tau]] - \
$CellContext`St[$CellContext`\[Tau]] 
        Derivative[1][$CellContext`\[Phi]t][$CellContext`\[Tau]]))}, 1, 2, 1],
  
  Editable->False]], "Output",
 CellChangeTimes->{
  3.8969375673771353`*^9, {3.896937630620171*^9, 3.896937715624483*^9}, 
   3.896937746989635*^9, {3.896937800302867*^9, 3.896937821599197*^9}, 
   3.896938056880426*^9, 3.896938589896834*^9, 3.8969387311695547`*^9, 
   3.896940546827866*^9, 3.897020342859869*^9, 3.897032004509449*^9, 
   3.8970321619649153`*^9, 3.8971121684556017`*^9, 3.897112221515691*^9, 
   3.897555619237879*^9, 3.897634610541712*^9, 3.8976346593329268`*^9, 
   3.897635504759083*^9, 3.898590041913748*^9, 3.898656821186838*^9, 
   3.8986642336838017`*^9, 3.8986841027457123`*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"31bdfb9e-900c-4501-b79a-e2c1d4735fc7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Delta]\[Theta]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"\[Delta]\[Theta]t", "[", "\[Tau]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], "+", 
      
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", "r", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "[", "r", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["rt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
             RowBox[{
              RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["tt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}]}], " ", 
              RowBox[{
               SuperscriptBox["tt", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["\[Phi]t", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]}],
          ")"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], " ", 
         RowBox[{"h", "[", "r", "]"}]}]]]}], ")"}], " ", "\[Epsilon]"}], "+", 
   
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {$CellContext`r^2 (
      Cos[$CellContext`\[Phi]] 
       Derivative[1][$CellContext`\[Delta]\[Theta]t][$CellContext`\[Tau]] + 
      Sin[$CellContext`\[Phi]] $CellContext`\[Delta]\[Theta]t[$CellContext`\
\[Tau]] Derivative[
        1][$CellContext`\[Phi]t][$CellContext`\[Tau]]) + \
$CellContext`f[$CellContext`r] ($CellContext`f[$CellContext`r] \
$CellContext`h[$CellContext`r])^
      Rational[-1, 2] ($CellContext`h[$CellContext`r] 
       Sin[$CellContext`\[Phi]] ($CellContext`St[$CellContext`\[Tau]] 
         Derivative[
          1][$CellContext`rt][$CellContext`\[Tau]] - \
$CellContext`Sr[$CellContext`\[Tau]] 
        Derivative[1][$CellContext`tt][$CellContext`\[Tau]]) + $CellContext`r 
       Cos[$CellContext`\[Phi]] (-$CellContext`S\[Phi][$CellContext`\[Tau]] 
         Derivative[
          1][$CellContext`tt][$CellContext`\[Tau]] + \
$CellContext`St[$CellContext`\[Tau]] 
         Derivative[1][$CellContext`\[Phi]t][$CellContext`\[Tau]]))}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.8969375673771353`*^9, {3.896937630620171*^9, 3.896937715624483*^9}, 
   3.896937746989635*^9, {3.896937800302867*^9, 3.896937821599197*^9}, 
   3.896938056880426*^9, 3.896938589896834*^9, 3.8969387311695547`*^9, 
   3.896940546827866*^9, 3.897020342859869*^9, 3.897032004509449*^9, 
   3.8970321619649153`*^9, 3.8971121684556017`*^9, 3.897112221515691*^9, 
   3.897555619237879*^9, 3.897634610541712*^9, 3.8976346593329268`*^9, 
   3.897635504759083*^9, 3.898590041913748*^9, 3.898656821186838*^9, 
   3.8986642336838017`*^9, 3.898684103030644*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"a9c22040-40eb-4561-80e0-8e12e83abef1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "two", " ", "expressions", " ", "below", " ", "vanish", " ", 
    "independently"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"k1", " ", "=", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Jx", "/.", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", "->", 
             RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Theta]t", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], 
             ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
       "Simplify"}], ",", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"k2", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Jx", "/.", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "->", 
              RowBox[{"\[Theta]t", "[", "\[Tau]", "]"}]}], "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\[Theta]t", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], 
              ")"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
        "Simplify"}], ",", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "]"}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{
  3.896937785863517*^9, {3.8969378338599873`*^9, 3.896937856149604*^9}, {
   3.8969380683295193`*^9, 3.8969380725880537`*^9}, {3.896938247483856*^9, 
   3.89693831307843*^9}, {3.896938548377475*^9, 3.896938563381028*^9}, {
   3.896938740445856*^9, 3.896938744581655*^9}, {3.89763610412428*^9, 
   3.8976361240561934`*^9}, {3.897636253146324*^9, 3.897636258732924*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"9dbd40e3-d0a7-40bc-af75-d7d6de4e5340"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"f", "[", "r", "]"}], " ", 
    RowBox[{"h", "[", "r", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
       RowBox[{
        SuperscriptBox["rt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
       RowBox[{
        SuperscriptBox["tt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
   SqrtBox[
    RowBox[{
     RowBox[{"f", "[", "r", "]"}], " ", 
     RowBox[{"h", "[", "r", "]"}]}]]], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{"\[Delta]\[Theta]t", "[", "\[Tau]", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Phi]t", "\[Prime]",
     MultilineFunction->None], "[", "\[Tau]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.896937845786333*^9, 3.896937856775515*^9}, 
   3.896938073308558*^9, {3.8969382586293364`*^9, 3.896938313462144*^9}, 
   3.896938592152417*^9, 3.896938745456786*^9, 3.89702034323132*^9, 
   3.897032004848926*^9, 3.897032162020814*^9, 3.897112168759255*^9, 
   3.897112221558978*^9, 3.897555619637445*^9, 3.8976346109280148`*^9, 
   3.897634659593864*^9, 3.897635505155717*^9, 3.8976361264804*^9, 
   3.897636264866487*^9, 3.898590042242608*^9, 3.898656821552081*^9, 
   3.8986642340386953`*^9, 3.8986841030723953`*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"3ed8e50e-23eb-4583-ac91-34e316562df9"],

Cell[BoxData[
 RowBox[{"r", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "r"}], " ", 
     RowBox[{
      SuperscriptBox["\[Delta]\[Theta]t", "\[Prime]",
       MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
         RowBox[{
          SuperscriptBox["tt", "\[Prime]",
           MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
        RowBox[{
         RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]t", "\[Prime]",
           MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       RowBox[{"f", "[", "r", "]"}], " ", 
       RowBox[{"h", "[", "r", "]"}]}]]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.896937845786333*^9, 3.896937856775515*^9}, 
   3.896938073308558*^9, {3.8969382586293364`*^9, 3.896938313462144*^9}, 
   3.896938592152417*^9, 3.896938745456786*^9, 3.89702034323132*^9, 
   3.897032004848926*^9, 3.897032162020814*^9, 3.897112168759255*^9, 
   3.897112221558978*^9, 3.897555619637445*^9, 3.8976346109280148`*^9, 
   3.897634659593864*^9, 3.897635505155717*^9, 3.8976361264804*^9, 
   3.897636264866487*^9, 3.898590042242608*^9, 3.898656821552081*^9, 
   3.8986642340386953`*^9, 3.898684103117813*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"0248c0ec-eb70-437f-9fe4-cc191a3d2193"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "One", " ", "expression", " ", "gives", " ", "a", " ", "constraint", " ", 
     "for", " ", "\[Delta]\[Theta]t"}], ",", " ", 
    RowBox[{
     RowBox[{"another", " ", "one", " ", "for", " ", 
      RowBox[{
       RowBox[{"\[Delta]\[Theta]t", "'"}], ".", " ", "Are"}], " ", "they", 
      " ", "self"}], "-", 
     RowBox[{"consistent", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"k1", " ", "==", "0"}], ",", 
     RowBox[{"\[Delta]\[Theta]t", "[", "\[Tau]", "]"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8969383588195353`*^9, 3.896938391971249*^9}, {
  3.8969384427352858`*^9, 3.896938446138661*^9}, {3.896938828893261*^9, 
  3.896938879141696*^9}, {3.896940564318679*^9, 3.8969406032575893`*^9}, {
  3.897636273141967*^9, 3.8976362733865*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"ab3a76bc-4637-474e-9fea-e967b7bd4bda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Delta]\[Theta]t", "[", "\[Tau]", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"f", "[", "r", "]"}], " ", 
        RowBox[{"h", "[", "r", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"St", "[", "\[Tau]", "]"}]}], " ", 
         RowBox[{
          SuperscriptBox["rt", "\[Prime]",
           MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
         RowBox[{
          SuperscriptBox["tt", "\[Prime]",
           MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.896938368692872*^9, 3.8969383923954287`*^9}, 
   3.896938448871838*^9, {3.896938844098547*^9, 3.896938860588696*^9}, 
   3.897020343349091*^9, 3.897032004954821*^9, 3.897032162058466*^9, 
   3.897112168848954*^9, 3.897112221603364*^9, 3.897555619744533*^9, 
   3.8976346110365543`*^9, 3.8976346596943913`*^9, 3.897635505257124*^9, 
   3.897636274095929*^9, 3.898590042341732*^9, 3.898656821658544*^9, 
   3.898664234142165*^9, 3.8986841031560793`*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"b96318cf-7162-4123-a617-ac25e9c23b8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{
                   SqrtBox[
                    RowBox[{
                    RowBox[{"f", "[", "r", "]"}], " ", 
                    RowBox[{"h", "[", "r", "]"}]}]], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"St", "[", "\[Tau]", "]"}]}], " ", 
                    RowBox[{
                    SuperscriptBox["rt", "\[Prime]",
                    MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
                    RowBox[{
                    SuperscriptBox["tt", "\[Prime]",
                    MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], 
                    ")"}]}], 
                  RowBox[{" ", 
                   RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{
                    SuperscriptBox["\[Phi]t", "\[Prime]",
                    MultilineFunction->None], "[", "\[Tau]", "]"}]}]}]], "/.",
                  "TrRule"}], ",", "\[Tau]"}], "]"}], "//", 
              RowBox[{
               RowBox[{"Simplify", "/.", "xEOM"}], "/.", "SEOM"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], "/.", "SEOM"}], "/.",
           "xEOM"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]t", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], 
            ")"}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], "/.", "TrRule"}], "//", 
      "Simplify"}], ")"}], "/.", "TrRule"}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Theta]t", "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8969388831780233`*^9, 3.896938925293845*^9}, {
   3.8969389761320143`*^9, 3.896938997369741*^9}, {3.896939032247736*^9, 
   3.8969390345842037`*^9}, {3.896939109804639*^9, 3.896939194583394*^9}, {
   3.896939546806018*^9, 3.8969396901425323`*^9}, 3.896939828867157*^9, 
   3.8976363102286787`*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"b20d5812-0935-4b99-9a20-af9c1f350794"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["tt", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
     RowBox[{
      RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
     RowBox[{"h", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]], " ", 
   RowBox[{"rt", "[", "\[Tau]", "]"}]}]]], "Output",
 CellChangeTimes->{{3.89693966494562*^9, 3.896939691771145*^9}, 
   3.89693982942411*^9, 3.897020343424848*^9, 3.897032005021969*^9, 
   3.8970321620932703`*^9, 3.897112168876957*^9, 3.897112221626824*^9, 
   3.897555619821999*^9, 3.897634611091073*^9, 3.897634659735568*^9, 
   3.8976355053335257`*^9, 3.898590042422948*^9, 3.898656821737543*^9, 
   3.898664234238769*^9, 3.898684103221794*^9},
 CellLabel->
  "Out[145]=",ExpressionUUID->"bc508aeb-51bd-4544-ac62-027f84018a64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"The", " ", "first", " ", "identity", " ", "for", " ", 
    RowBox[{"\[Delta]\[Theta]t", "[", "\[Tau]", "]"}], " ", "implies", " ", 
    "the", " ", "vanishing", " ", "of", " ", "the", " ", "second", " ", 
    "identity", " ", "involving", " ", 
    RowBox[{
     RowBox[{"\[Delta]\[Theta]t", "'"}], "[", "\[Tau]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r"}], " ", 
         RowBox[{
          SuperscriptBox["\[Delta]\[Theta]t", "\[Prime]",
           MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"f", "[", "r", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["tt", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
            RowBox[{
             RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Phi]t", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
         SqrtBox[
          RowBox[{
           RowBox[{"f", "[", "r", "]"}], " ", 
           RowBox[{"h", "[", "r", "]"}]}]]]}], ")"}]}], "/.", "TrRule"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Delta]\[Theta]t", "\[Prime]",
        MultilineFunction->None], "[", "\[Tau]", "]"}], "->", 
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["tt", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
          RowBox[{
           RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Phi]t", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]], " ", 
        RowBox[{"rt", "[", "\[Tau]", "]"}]}]]}], "}"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.896939267726922*^9, 3.8969393049009037`*^9}, {
  3.8969397096085978`*^9, 3.8969397691942368`*^9}, {3.896939836544549*^9, 
  3.896939843750503*^9}, {3.897636318344349*^9, 3.897636323901462*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"004c1d1f-58d3-4e21-8703-b43263cc4449"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.896939292159437*^9, 3.896939305580555*^9}, 
   3.896939710528883*^9, {3.896939836938748*^9, 3.896939844584877*^9}, 
   3.897020343469885*^9, 3.8970320050440073`*^9, 3.897032162114575*^9, 
   3.897112168897427*^9, 3.897112221653986*^9, 3.897555619873826*^9, 
   3.8976346111261883`*^9, 3.897634659772884*^9, 3.8976355053827343`*^9, 
   3.898590042458828*^9, 3.898656821775075*^9, 3.898664234276758*^9, 
   3.898684103267098*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"049d3db3-e137-4ae7-9750-7b0f6812e0e2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving in aligned coordinates", "Section",
 CellChangeTimes->{{3.896940618574464*^9, 
  3.8969406377977943`*^9}},ExpressionUUID->"63b52513-bb28-4c60-bcb9-\
65b09eb24e7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "remaining", " ", "constants", " ", "of", " ", "motion", " ", 
    "have", " ", "no", " ", "dependence", " ", "on", " ", "theta", " ", "at", 
    " ", "given", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Es", "/.", "TrRule"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Theta]t", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], ")"}]}], 
       "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"/.", "fhRule"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", " ", 
       RowBox[{"sp", "/", 
        RowBox[{"rt", "[", "\[Tau]", "]"}]}]}], "}"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Jz", "/.", "TrRule"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Theta]t", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], ")"}]}], 
       "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"spara", "/.", "TrRule"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]t", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], ")"}]}],
         "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Phi]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}], 
     "&"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"/.", "fhRule"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", " ", 
        RowBox[{"sp", "/", 
         RowBox[{"rt", "[", "\[Tau]", "]"}]}]}], "}"}]}], 
     "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.896940695537272*^9, 3.896940721258299*^9}, {
  3.896940752795742*^9, 3.8969407808192987`*^9}, {3.8969408233872757`*^9, 
  3.8969408479856873`*^9}, {3.89694105491425*^9, 3.896941074589807*^9}, {
  3.897554468045313*^9, 3.897554530234317*^9}, {3.897554630175596*^9, 
  3.8975546327870092`*^9}, {3.8986593329670067`*^9, 3.8986593403621683`*^9}, {
  3.898659497551775*^9, 3.8986595292987823`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"ffed0b28-13ba-4acd-92c9-386bcb51f69e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["tt", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"rt", "[", "\[Tau]", "]"}], "2"], " ", 
     RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["f", "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]t", "\[Prime]",
       MultilineFunction->None], "[", "\[Tau]", "]"}], " ", "\[Epsilon]"}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
       RowBox[{"h", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {$CellContext`f[
      $CellContext`rt[$CellContext`\[Tau]]] 
    Derivative[1][$CellContext`tt][$CellContext`\[Tau]], 
    Rational[1, 2] ($CellContext`f[
        $CellContext`rt[$CellContext`\[Tau]]] $CellContext`h[
        $CellContext`rt[$CellContext`\[Tau]]])^
     Rational[-1, 
       2] $CellContext`rt[$CellContext`\[Tau]]^2 \
$CellContext`S\[Theta][$CellContext`\[Tau]] Derivative[1][$CellContext`f][
      $CellContext`rt[$CellContext`\[Tau]]] 
    Derivative[1][$CellContext`\[Phi]t][$CellContext`\[Tau]]}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8969407376937838`*^9, 3.896940770341337*^9}, {
   3.896940830908326*^9, 3.896940848682592*^9}, 3.8969411498945227`*^9, 
   3.89702034349326*^9, 3.897032005077059*^9, 3.897032162148458*^9, 
   3.897112168926569*^9, 3.8971122216744328`*^9, 3.897554478804242*^9, 
   3.897554530963085*^9, 3.897554633727893*^9, 3.89755561990691*^9, 
   3.89763461117807*^9, 3.8976346598016577`*^9, 3.8976355054252234`*^9, 
   3.898590042512697*^9, 3.8986568218262177`*^9, 3.898659340910799*^9, 
   3.89865948399144*^9, 3.898659530067257*^9, 3.8986642343275833`*^9, 
   3.898684103297247*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"330c2472-d298-4d88-ae22-baa7edf4ff52"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"rt", "[", "\[Tau]", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]t", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
     RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
     RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["tt", "\[Prime]",
       MultilineFunction->None], "[", "\[Tau]", "]"}], " ", "\[Epsilon]"}], 
    SqrtBox[
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
      RowBox[{"h", "[", 
       RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {$CellContext`rt[$CellContext`\[Tau]]^2 
    Derivative[1][$CellContext`\[Phi]t][$CellContext`\[Tau]], $CellContext`f[
      $CellContext`rt[$CellContext`\[Tau]]] ($CellContext`f[
        $CellContext`rt[$CellContext`\[Tau]]] $CellContext`h[
        $CellContext`rt[$CellContext`\[Tau]]])^
     Rational[-1, 
       2] $CellContext`rt[$CellContext`\[Tau]] \
$CellContext`S\[Theta][$CellContext`\[Tau]] 
    Derivative[1][$CellContext`tt][$CellContext`\[Tau]]}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8969407376937838`*^9, 3.896940770341337*^9}, {
   3.896940830908326*^9, 3.896940848682592*^9}, 3.8969411498945227`*^9, 
   3.89702034349326*^9, 3.897032005077059*^9, 3.897032162148458*^9, 
   3.897112168926569*^9, 3.8971122216744328`*^9, 3.897554478804242*^9, 
   3.897554530963085*^9, 3.897554633727893*^9, 3.89755561990691*^9, 
   3.89763461117807*^9, 3.8976346598016577`*^9, 3.8976355054252234`*^9, 
   3.898590042512697*^9, 3.8986568218262177`*^9, 3.898659340910799*^9, 
   3.89865948399144*^9, 3.898659530067257*^9, 3.8986642343275833`*^9, 
   3.8986841033180523`*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"20733ce2-a00c-4aca-a21b-d03eb73c061f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
    RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {$CellContext`rt[$CellContext`\[Tau]] \
$CellContext`S\[Theta][$CellContext`\[Tau]]}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8969407376937838`*^9, 3.896940770341337*^9}, {
   3.896940830908326*^9, 3.896940848682592*^9}, 3.8969411498945227`*^9, 
   3.89702034349326*^9, 3.897032005077059*^9, 3.897032162148458*^9, 
   3.897112168926569*^9, 3.8971122216744328`*^9, 3.897554478804242*^9, 
   3.897554530963085*^9, 3.897554633727893*^9, 3.89755561990691*^9, 
   3.89763461117807*^9, 3.8976346598016577`*^9, 3.8976355054252234`*^9, 
   3.898590042512697*^9, 3.8986568218262177`*^9, 3.898659340910799*^9, 
   3.89865948399144*^9, 3.898659530067257*^9, 3.8986642343275833`*^9, 
   3.898684103377722*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"db3c0841-e8e0-4619-a77a-f6eb9834eb96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Perturbative", " ", "inversion", " ", "to", " ", "obtain", " ", "time", 
     " ", "and", " ", "phi", " ", "components", " ", "of", " ", "four"}], "-",
     "velocity"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"utint", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], 
        RowBox[{"(", 
         RowBox[{"\[ScriptCapitalE]", " ", "-", " ", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"rt", "[", "\[Tau]", "]"}], "2"], " ", 
              RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["f", "\[Prime]",
                MultilineFunction->None], "[", 
               RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
              RowBox[{
               SuperscriptBox["\[Phi]t", "\[Prime]",
                MultilineFunction->None], "[", "\[Tau]", "]"}]}], ")"}], " ", 
            "\[Epsilon]"}], 
           RowBox[{"2", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
              RowBox[{"h", "[", 
               RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]}]]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Phi]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}], "->", 
          RowBox[{"\[ScriptCapitalJ]", "/", 
           SuperscriptBox[
            RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]}], ",", 
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
          RowBox[{"sp", "/", 
           RowBox[{"rt", "[", "\[Tau]", "]"}]}]}]}], "}"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u\[Phi]int", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]], 
        RowBox[{"(", 
         RowBox[{"\[ScriptCapitalJ]", " ", "-", 
          FractionBox[
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
            RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["tt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}], " ", 
            "\[Epsilon]"}], 
           RowBox[{" ", 
            SqrtBox[
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
              RowBox[{"h", "[", 
               RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]}]]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["tt", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}], "->", 
          RowBox[{"\[ScriptCapitalE]", "/", 
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
          RowBox[{"sp", "/", 
           RowBox[{"rt", "[", "\[Tau]", "]"}]}]}]}], "}"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t\[Phi]Rule", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["tt", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], "->", "utint"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]t", "'"}], "[", "\[Tau]", "]"}], "->", 
        "u\[Phi]int"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"urint2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", "1"}], " ", "-", " ", 
            RowBox[{"gtt", " ", 
             SuperscriptBox["utint", "2"]}], " ", "-", " ", 
            RowBox[{"g\[Phi]\[Phi]", " ", 
             SuperscriptBox["u\[Phi]int", "2"]}]}], "grr"], "/.", "TrRule"}], 
         "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]t", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], 
            ")"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
      "Simplify"}], "//", "Normal"}]}], "\[IndentingNewLine]", 
   RowBox[{"URule", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["tt", "\[Prime]",
         MultilineFunction->None], "[", "\[Tau]", "]"}], "->", "utint"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]t", "'"}], "[", "\[Tau]", "]"}], "->", "u\[Phi]int"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"rt", "'"}], "[", "\[Tau]", "]"}], "->", 
       RowBox[{"Sqrt", "[", "urint2", "]"}]}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.89694134348731*^9, 3.896941567779666*^9}, {
   3.896941640579129*^9, 3.896941651390273*^9}, {3.8969417221140957`*^9, 
   3.896941813900628*^9}, {3.896941906587262*^9, 3.8969419071422253`*^9}, {
   3.896941939227611*^9, 3.89694210700211*^9}, {3.896942282849847*^9, 
   3.896942289298559*^9}, 3.896942334393632*^9, {3.896942605792634*^9, 
   3.8969426413319073`*^9}, 3.896947965969316*^9, {3.897112201219845*^9, 
   3.897112204741836*^9}, {3.897554657178062*^9, 3.8975546732189293`*^9}, {
   3.897555556204692*^9, 3.897555561820264*^9}, {3.8976354651862288`*^9, 
   3.897635468440422*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"58308630-958f-4fbd-88ff-8a9214db59c4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    FractionBox[
     SuperscriptBox["\[ScriptCapitalE]", "2"], 
     RowBox[{"f", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "-", 
    FractionBox[
     SuperscriptBox["\[ScriptCapitalJ]", "2"], 
     SuperscriptBox[
      RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}], 
   RowBox[{"h", "[", 
    RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "+", 
  FractionBox[
   RowBox[{
   "sp", " ", "\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]", " ", 
    "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
       RowBox[{
        SuperscriptBox["f", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
       RowBox[{"h", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}], ")"}], 
     RowBox[{"3", "/", "2"}]], " ", 
    SuperscriptBox[
     RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.896954688548915*^9, 3.8970203435474787`*^9, 
  3.897032005134132*^9, 3.897032162207549*^9, 3.8971121689822817`*^9, 
  3.8971122217271757`*^9, 3.897554675696995*^9, 3.8975555629608173`*^9, 
  3.897555619973147*^9, 3.8976346112577543`*^9, 3.897634659860116*^9, 
  3.897635505504385*^9, 3.898590042641329*^9, 3.898656821903713*^9, 
  3.898664234449252*^9, 3.8986841034230556`*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"b94ccf9d-cf29-48c9-97f3-961b33c9cb37"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["tt", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"\[ScriptCapitalE]", "-", 
      FractionBox[
       RowBox[{"sp", " ", "\[ScriptCapitalJ]", " ", "\[Epsilon]", " ", 
        RowBox[{
         SuperscriptBox["f", "\[Prime]",
          MultilineFunction->None], "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]], " ", 
        RowBox[{"rt", "[", "\[Tau]", "]"}]}]]}], 
     RowBox[{"f", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]t", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"\[ScriptCapitalJ]", "-", 
      FractionBox[
       RowBox[{"sp", " ", "\[ScriptCapitalE]", " ", "\[Epsilon]"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
         RowBox[{"h", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]]}], 
     SuperscriptBox[
      RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["rt", "\[Prime]",
      MultilineFunction->None], "[", "\[Tau]", "]"}], "\[Rule]", 
    SqrtBox[
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        FractionBox[
         SuperscriptBox["\[ScriptCapitalE]", "2"], 
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "-", 
        FractionBox[
         SuperscriptBox["\[ScriptCapitalJ]", "2"], 
         SuperscriptBox[
          RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}], 
       RowBox[{"h", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "+", 
      FractionBox[
       RowBox[{
       "sp", " ", "\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]", " ", 
        "\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["f", "\[Prime]",
             MultilineFunction->None], "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
           RowBox[{"h", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        SuperscriptBox[
         RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]]}]]}]}], "}"}]], "Output",\

 CellChangeTimes->{3.896954688548915*^9, 3.8970203435474787`*^9, 
  3.897032005134132*^9, 3.897032162207549*^9, 3.8971121689822817`*^9, 
  3.8971122217271757`*^9, 3.897554675696995*^9, 3.8975555629608173`*^9, 
  3.897555619973147*^9, 3.8976346112577543`*^9, 3.897634659860116*^9, 
  3.897635505504385*^9, 3.898590042641329*^9, 3.898656821903713*^9, 
  3.898664234449252*^9, 3.898684103443316*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"002243d2-92b4-4b62-b966-3a0739137cb4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parallel transport in Marck-like tetrad", "Section",
 CellChangeTimes->{{3.897104557987749*^9, 3.8971045693212023`*^9}, {
  3.898658225255525*^9, 
  3.898658226752953*^9}},ExpressionUUID->"87861389-68a6-48a5-9d18-\
d0063a9a2feb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "spin", " ", "vector", " ", "fulfills", " ", "non"}], 
    "-", 
    RowBox[{"trivial", " ", "parallel"}], "-", 
    RowBox[{"transport", " ", "equations"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Svec", ",", "\[Tau]"}], "]"}], "/.", "SEOM"}], "/.", 
       "TrRule"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Theta]t", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"\[Delta]\[Theta]t", "[", "#", "]"}]}]}], "&"}], ")"}]}], 
       "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.896939956491477*^9, 3.896940060974391*^9}, {
   3.896940201063921*^9, 3.896940214412848*^9}, 3.896941234613433*^9, {
   3.8969421827274837`*^9, 3.896942219488669*^9}, {3.896942262961382*^9, 
   3.896942263544795*^9}, {3.896942319957762*^9, 3.896942430510363*^9}, 
   3.896942988500832*^9, {3.896944648365781*^9, 3.896944700266099*^9}, 
   3.896946452124037*^9, 3.8969482556801357`*^9, 3.896959764867244*^9, {
   3.8969598046291533`*^9, 3.896959807759108*^9}, {3.897032151764832*^9, 
   3.897032154771344*^9}, {3.898658252992379*^9, 3.898658298483004*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"25eafbae-e458-41b3-8f4a-383145936054"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["rt", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["tt", "\[Prime]",
               MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
         ")"}], " ", "\[Epsilon]"}], 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]}], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
      SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
      Editable->False]}],
    SeriesData[$CellContext`\[Epsilon], 0, {Rational[-1, 2] $CellContext`f[
         $CellContext`rt[$CellContext`\[Tau]]]^(-1) 
      Derivative[1][$CellContext`f][
        $CellContext`rt[$CellContext`\[Tau]]] ($CellContext`St[$CellContext`\
\[Tau]] Derivative[
         1][$CellContext`rt][$CellContext`\[Tau]] + \
$CellContext`Sr[$CellContext`\[Tau]] 
        Derivative[1][$CellContext`tt][$CellContext`\[Tau]])}, 1, 2, 1],
    Editable->False], ",", 
   InterpretationBox[
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["rt", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Phi]t", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}], " ", 
        "\[Epsilon]"}], 
       RowBox[{"rt", "[", "\[Tau]", "]"}]]}], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
      SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
      Editable->False]}],
    SeriesData[$CellContext`\[Epsilon], 
     0, {-$CellContext`rt[$CellContext`\[Tau]]^(-1) \
($CellContext`S\[Phi][$CellContext`\[Tau]] 
        Derivative[
         1][$CellContext`rt][$CellContext`\[Tau]] + \
$CellContext`Sr[$CellContext`\[Tau]] 
        Derivative[1][$CellContext`\[Phi]t][$CellContext`\[Tau]])}, 1, 2, 1],
    Editable->False], ",", 
   InterpretationBox[
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["h", "\[Prime]",
             MultilineFunction->None], "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["rt", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"St", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["f", "\[Prime]",
             MultilineFunction->None], "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["tt", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
           RowBox[{"S\[Phi]", "[", "\[Tau]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Phi]t", "\[Prime]",
             MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}], " ", 
        "\[Epsilon]"}], 
       RowBox[{"2", " ", 
        RowBox[{"h", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]]}], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
      SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
      Editable->False]}],
    SeriesData[$CellContext`\[Epsilon], 0, {Rational[-1, 2] $CellContext`h[
         $CellContext`rt[$CellContext`\[Tau]]]^(-1) \
($CellContext`Sr[$CellContext`\[Tau]] Derivative[1][$CellContext`h][
          $CellContext`rt[$CellContext`\[Tau]]] 
        Derivative[
         1][$CellContext`rt][$CellContext`\[Tau]] + \
$CellContext`St[$CellContext`\[Tau]] Derivative[1][$CellContext`f][
          $CellContext`rt[$CellContext`\[Tau]]] 
        Derivative[1][$CellContext`tt][$CellContext`\[Tau]] - 
       2 $CellContext`rt[$CellContext`\[Tau]] \
$CellContext`S\[Phi][$CellContext`\[Tau]] 
       Derivative[1][$CellContext`\[Phi]t][$CellContext`\[Tau]])}, 1, 2, 1],
    Editable->False], ",", 
   InterpretationBox[
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], " ", 
        RowBox[{
         SuperscriptBox["rt", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], " ", "\[Epsilon]"}], 
       RowBox[{"rt", "[", "\[Tau]", "]"}]]}], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
      SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
      Editable->False]}],
    SeriesData[$CellContext`\[Epsilon], 
     0, {-$CellContext`rt[$CellContext`\[Tau]]^(-1) \
$CellContext`S\[Theta][$CellContext`\[Tau]] 
      Derivative[1][$CellContext`rt][$CellContext`\[Tau]]}, 1, 2, 1],
    Editable->False]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896940024351173*^9, 3.8969400626905622`*^9, 3.8969402150531473`*^9, {
   3.896941225350616*^9, 3.896941235254032*^9}, {3.896942195392992*^9, 
   3.896942220175866*^9}, {3.8969423772104597`*^9, 3.8969424315547*^9}, 
   3.8969429891659307`*^9, {3.896944656864316*^9, 3.8969447019921827`*^9}, 
   3.896946455318823*^9, 3.896948256855917*^9, 3.896959766497377*^9, 
   3.896959808883615*^9, 3.8970203437290287`*^9, 3.897032005325115*^9, {
   3.897032157549478*^9, 3.8970321622903347`*^9}, 3.897112169145862*^9, 
   3.8971122218072987`*^9, 3.897555620133731*^9, 3.8976346114192867`*^9, 
   3.897634659951427*^9, 3.897635505656351*^9, 3.898590042790859*^9, 
   3.898656822063777*^9, {3.898658293187458*^9, 3.898658300108007*^9}, 
   3.8986642345504017`*^9, 3.8986841035000277`*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"321b0762-3d6b-4a4e-a575-e320d26de248"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", "Marck"}], "-", 
     RowBox[{"like", " ", "tetrad", " ", "e0"}]}], ",", "er", ",", "e\[Phi]", 
    ",", 
    RowBox[{"e\[Theta]", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "indices", " ", "up"}], ")"}], " ", "allows", " ", 
     "to", " ", "simplify", " ", "parallel", " ", "transport"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LeadURule", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["tt", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], "->", 
        RowBox[{"\[ScriptCapitalE]", "/", 
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Phi]t", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], "->", 
        RowBox[{"\[ScriptCapitalJ]", "/", 
         SuperscriptBox[
          RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"rt", "'"}], "[", "\[Tau]", "]"}], "->", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           FractionBox[
            SuperscriptBox["\[ScriptCapitalE]", "2"], 
            RowBox[{"f", "[", 
             RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "-", 
           FractionBox[
            SuperscriptBox["\[ScriptCapitalJ]", "2"], 
            SuperscriptBox[
             RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}], 
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]]]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"e\[Theta]", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", "r"]}], "}"}], "/.", "TrRule"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"e0", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["tt", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], ",", 
        RowBox[{
         SuperscriptBox["\[Phi]t", "\[Prime]",
          MultilineFunction->None], "[", "\[Tau]", "]"}], ",", 
        RowBox[{
         RowBox[{"rt", "'"}], "[", "\[Tau]", "]"}], ",", "0"}], "}"}], "/.", 
      "LeadURule"}], "/.", "TrRule"}]}], "\[IndentingNewLine]", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"These", " ", "are", " ", "denoted", " ", "as", " ", 
      SubscriptBox[
       OverscriptBox["e", "~"], "r"]}], ",", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["e", "~"], "\[CurlyPhi]"], " ", "in", " ", "the", " ", 
      RowBox[{"paper", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ersol", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["etr", "2"], "gtt"}], " ", "+", " ", 
                RowBox[{
                 SuperscriptBox["err", "2"], "grr"}]}], "/.", "TrRule"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Theta]t", "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], 
             " ", ")"}], "==", " ", "1"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"etr", " ", 
                 RowBox[{"e0", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "gtt"}], " ", "+", " ", 
                RowBox[{"err", " ", 
                 RowBox[{"e0", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "grr"}]}], "/.", "TrRule"}],
               "/.", 
              RowBox[{"{", 
               RowBox[{"\[Theta]t", "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], 
             ")"}], " ", "==", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"etr", ",", "err"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"er", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"etr", ",", "0", ",", "err", ",", "0"}], "}"}], "/.", 
     RowBox[{"ersol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e\[Phi]sol", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["et\[Phi]", "2"], "gtt"}], " ", "+", " ", 
                 RowBox[{
                  SuperscriptBox["e\[Phi]\[Phi]", "2"], "grr"}], "+", " ", 
                 RowBox[{
                  SuperscriptBox["er\[Phi]", "2"], "grr"}]}], "/.", 
                "TrRule"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]t", "->", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], 
              " ", ")"}], "==", " ", "1"}], ","}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"et\[Phi]", " ", 
                 RowBox[{"e0", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "gtt"}], "+", 
                RowBox[{"1", " ", 
                 RowBox[{"e0", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "g\[Phi]\[Phi]"}], " ", "+",
                 " ", 
                RowBox[{"er\[Phi]", " ", 
                 RowBox[{"e0", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "grr"}]}], "/.", "TrRule"}],
               "/.", 
              RowBox[{"{", 
               RowBox[{"\[Theta]t", "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], 
             ")"}], " ", "==", "0"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"et\[Phi]", " ", 
                 RowBox[{"er", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "gtt"}], "+", 
                RowBox[{"1", " ", 
                 RowBox[{"er", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "g\[Phi]\[Phi]"}], " ", "+",
                 " ", 
                RowBox[{"er\[Phi]", " ", 
                 RowBox[{"er", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "grr"}]}], "/.", "TrRule"}],
               "/.", 
              RowBox[{"{", 
               RowBox[{"\[Theta]t", "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], 
             ")"}], " ", "==", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"et\[Phi]", ",", 
           RowBox[{"(*", 
            RowBox[{"e\[Phi]\[Phi]", ","}], "*)"}], "er\[Phi]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
           SuperscriptBox[
            RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ">", "0"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N\[Phi]", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"et\[Phi]", " ", ",", "1", ",", "er\[Phi]", ",", "0"}], "}"}], 
      "/.", 
      RowBox[{"e\[Phi]sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"e\[Phi]", " ", "=", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"N\[Phi]", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"N\[Phi]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"N\[Phi]", "[", 
              RowBox[{"[", "j", "]"}], "]"}], 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "/.", "TrRule"}], "/.", 
           RowBox[{"{", 
            RowBox[{"\[Theta]t", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Pi]", "/", "2"}], " ", "&"}], ")"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ")"}], 
     "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", " ", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
            SuperscriptBox[
             RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ">", "0"}]}], 
         "}"}]}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "These", " ", "reduce", " ", "to", " ", "the", " ", "legs", " ", "of", 
     " ", "the", " ", "Marck", " ", "tetrad", " ", "in", " ", 
     "Schwarzschild"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8969440671722937`*^9, 3.896944212221252*^9}, {
   3.896944628321567*^9, 3.896944636964793*^9}, {3.896944732921709*^9, 
   3.896944996634864*^9}, {3.896945203864024*^9, 3.896945221678597*^9}, {
   3.89694569171835*^9, 3.896945725142815*^9}, 3.896946111417325*^9, {
   3.89694646593657*^9, 3.8969464689197683`*^9}, {3.896952398064419*^9, 
   3.896952427744338*^9}, {3.89695246795844*^9, 3.8969525141578197`*^9}, {
   3.896952563942121*^9, 3.896952564418521*^9}, {3.8969525969150543`*^9, 
   3.8969526248559523`*^9}, {3.896952691226131*^9, 3.896952859895483*^9}, {
   3.8969528906293783`*^9, 3.896952950393342*^9}, {3.896953038141088*^9, 
   3.896953120642099*^9}, {3.896953846483046*^9, 3.8969538495630293`*^9}, {
   3.896954713034017*^9, 3.8969547150996304`*^9}, {3.896955072960103*^9, 
   3.896955130362166*^9}, {3.8969553275857773`*^9, 3.896955338006734*^9}, 
   3.89695547010664*^9, {3.896957663136204*^9, 3.896957682504258*^9}, {
   3.896957712975816*^9, 3.896957723481279*^9}, {3.8969578237340593`*^9, 
   3.896957850851632*^9}, {3.8970349436618557`*^9, 3.897034946847337*^9}, 
   3.897035099437593*^9, {3.897035421111298*^9, 3.897035465554144*^9}, {
   3.89703647834004*^9, 3.8970365025250063`*^9}, {3.89703655355606*^9, 
   3.897036556568378*^9}, {3.897036640661276*^9, 3.897036643942874*^9}, {
   3.897037276419685*^9, 3.897037304743421*^9}, {3.898658313408847*^9, 
   3.8986583717928953`*^9}, {3.898658443882965*^9, 3.89865848075972*^9}, {
   3.898658511293988*^9, 3.8986585665972157`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"605dcd28-01f2-433f-92da-b35e917b7d06"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"rt", "[", "\[Tau]", "]"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.897036479284357*^9, 3.897036502895377*^9}, 
   3.897036557290436*^9, 3.897036644315075*^9, 3.897037312788228*^9, 
   3.8971121691851263`*^9, 3.897112221829756*^9, 3.897555620164565*^9, 
   3.897634611456807*^9, 3.897634659981737*^9, 3.897635505687973*^9, 
   3.898590042827484*^9, 3.8986568221042967`*^9, 3.898658384738109*^9, 
   3.8986642345917473`*^9, 3.89868410352927*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"d644a469-2c00-448b-a8b1-b1e2a332c247"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["\[ScriptCapitalE]", 
    RowBox[{"f", "[", 
     RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], ",", 
   FractionBox["\[ScriptCapitalJ]", 
    SuperscriptBox[
     RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]], ",", 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       SuperscriptBox["\[ScriptCapitalE]", "2"], 
       RowBox[{"f", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "-", 
      FractionBox[
       SuperscriptBox["\[ScriptCapitalJ]", "2"], 
       SuperscriptBox[
        RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}], 
     RowBox[{"h", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.897036479284357*^9, 3.897036502895377*^9}, 
   3.897036557290436*^9, 3.897036644315075*^9, 3.897037312788228*^9, 
   3.8971121691851263`*^9, 3.897112221829756*^9, 3.897555620164565*^9, 
   3.897634611456807*^9, 3.897634659981737*^9, 3.897635505687973*^9, 
   3.898590042827484*^9, 3.8986568221042967`*^9, 3.898658384738109*^9, 
   3.8986642345917473`*^9, 3.89868410354955*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"1687973d-c2ef-43a0-8dad-ccbbe2fd3674"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox[
        SuperscriptBox["\[ScriptCapitalE]", "2"], 
        RowBox[{"f", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "-", 
       FractionBox[
        SuperscriptBox["\[ScriptCapitalJ]", "2"], 
        SuperscriptBox[
         RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}]], " ", 
     RowBox[{"rt", "[", "\[Tau]", "]"}]}], 
    SqrtBox[
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
        SuperscriptBox[
         RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]], ",", "0", ",", 
   FractionBox[
    RowBox[{"\[ScriptCapitalE]", " ", 
     RowBox[{"rt", "[", "\[Tau]", "]"}]}], 
    SqrtBox[
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
      RowBox[{"h", "[", 
       RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
        SuperscriptBox[
         RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.897036479284357*^9, 3.897036502895377*^9}, 
   3.897036557290436*^9, 3.897036644315075*^9, 3.897037312788228*^9, 
   3.8971121691851263`*^9, 3.897112221829756*^9, 3.897555620164565*^9, 
   3.897634611456807*^9, 3.897634659981737*^9, 3.897635505687973*^9, 
   3.898590042827484*^9, 3.8986568221042967`*^9, 3.898658384738109*^9, 
   3.8986642345917473`*^9, 3.89868410370541*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"03d16977-6711-4432-9fcd-c3eeb24072e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]"}], 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]]}]], ",", 
   FractionBox[
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
      SuperscriptBox[
       RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]], 
    SuperscriptBox[
     RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]], ",", 
   FractionBox[
    RowBox[{"\[ScriptCapitalJ]", " ", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalE]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
            SuperscriptBox[
             RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]}], 
       RowBox[{"h", "[", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]]]}], 
    RowBox[{"rt", "[", "\[Tau]", "]"}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.897036479284357*^9, 3.897036502895377*^9}, 
   3.897036557290436*^9, 3.897036644315075*^9, 3.897037312788228*^9, 
   3.8971121691851263`*^9, 3.897112221829756*^9, 3.897555620164565*^9, 
   3.897634611456807*^9, 3.897634659981737*^9, 3.897635505687973*^9, 
   3.898590042827484*^9, 3.8986568221042967`*^9, 3.898658384738109*^9, 
   3.8986642345917473`*^9, 3.898684104009678*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"a01681d4-aa29-4bc4-afc1-f0d3ecfcb4c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sanity", " ", 
    RowBox[{"check", ":", " ", 
     RowBox[{"is", " ", "tetrad", " ", 
      RowBox[{"orthonormal", "?"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Emat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"e0", ",", "e\[Phi]", ",", "er", ",", "e\[Theta]"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Emat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], 
            RowBox[{"Emat", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "l"}], "]"}], "]"}], 
            RowBox[{"g", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "l"}], "]"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", "->", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "/.", "TrRule"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
         SuperscriptBox[
          RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ">", "0"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8969440671722937`*^9, 3.896944212221252*^9}, {
   3.896944628321567*^9, 3.896944636964793*^9}, {3.896944732921709*^9, 
   3.896944996634864*^9}, {3.896945203864024*^9, 3.896945221678597*^9}, {
   3.89694569171835*^9, 3.896945725142815*^9}, 3.896946111417325*^9, {
   3.89694646593657*^9, 3.8969464689197683`*^9}, {3.896952398064419*^9, 
   3.896952427744338*^9}, {3.89695246795844*^9, 3.8969525141578197`*^9}, {
   3.896952563942121*^9, 3.896952564418521*^9}, {3.8969525969150543`*^9, 
   3.8969526248559523`*^9}, {3.896952691226131*^9, 3.896952859895483*^9}, {
   3.8969528906293783`*^9, 3.896952950393342*^9}, {3.896953038141088*^9, 
   3.896953120642099*^9}, {3.896953846483046*^9, 3.8969538495630293`*^9}, {
   3.896954713034017*^9, 3.8969547150996304`*^9}, {3.896955072960103*^9, 
   3.896955130362166*^9}, {3.8969553275857773`*^9, 3.896955338006734*^9}, {
   3.89695547010664*^9, 3.896955599899535*^9}, {3.896955630083638*^9, 
   3.896955676342862*^9}, {3.896955721389625*^9, 3.8969557951280003`*^9}, {
   3.896955835822418*^9, 3.896955836169303*^9}, 3.896957768132409*^9, {
   3.896957840040515*^9, 3.896957866529848*^9}, 3.897036598803113*^9, {
   3.897036656679285*^9, 3.8970366618655376`*^9}, {3.898658394605908*^9, 
   3.8986584104445963`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"72bcd2eb-92cd-4c2b-8551-61ee1faba4ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8969547174489527`*^9, {3.8969551078295918`*^9, 3.8969551328285217`*^9}, 
   3.896955338755353*^9, {3.8969555894642344`*^9, 3.896955600991404*^9}, {
   3.8969556495700912`*^9, 3.896955676987454*^9}, {3.896955723289358*^9, 
   3.896955744405796*^9}, {3.89695578590763*^9, 3.896955795634204*^9}, 
   3.896955836901766*^9, 3.896957731556458*^9, 3.896957769279046*^9, {
   3.896957840746704*^9, 3.8969578670039682`*^9}, 3.896959784955084*^9, 
   3.896959815197279*^9, 3.897020343898273*^9, 3.897032005780389*^9, 
   3.897032162423183*^9, {3.897036592134714*^9, 3.897036599704844*^9}, 
   3.8970366630343857`*^9, 3.897112169869123*^9, 3.8971122220645723`*^9, 
   3.8975556208907423`*^9, 3.8976346121799498`*^9, 3.8976346605615683`*^9, 
   3.897635506406151*^9, 3.89859004353122*^9, 3.8986568228174467`*^9, 
   3.898664235316453*^9, 3.898684104231579*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"9a1b710b-b3f1-408c-8cb0-0291f8d08307"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Similarly", " ", "to", " ", "Marck"}], ",", " ", 
    RowBox[{
     RowBox[{"we", " ", "define", " ", "a", " ", "parallel"}], "-", 
     RowBox[{
     "transported", " ", "tetrad", " ", "using", " ", "the", " ", "just", " ",
       "defined", " ", "legs"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"erder", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"er", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\[Tau]"}], "]"}], "+", 
              
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ChrisSchw", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
                 RowBox[{"er", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], 
                 RowBox[{"e0", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "->", 
              RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "/.", "TrRule"}], "/.", 
          "LeadURule"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Psi]dot", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"erder", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"e\[Phi]", "[", 
            RowBox[{"[", "l", "]"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "l"}], "]"}], "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", "->", 
            RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "/.", "TrRule"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalE]", ">", "0"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ">", "0"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]dot", "/.", "fhRule"}], "//", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], ">", 
          RowBox[{"2", "M"}], ">", "0"}], ",", 
         RowBox[{"\[ScriptCapitalE]", ">", "0"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
           SuperscriptBox[
            RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ">", "0"}]}], "}"}]}],
       "]"}], "&"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8969440671722937`*^9, 3.896944212221252*^9}, {
   3.896944628321567*^9, 3.896944636964793*^9}, {3.896944732921709*^9, 
   3.896944996634864*^9}, {3.896945203864024*^9, 3.896945221678597*^9}, {
   3.89694569171835*^9, 3.896945725142815*^9}, 3.896946111417325*^9, {
   3.89694646593657*^9, 3.8969464689197683`*^9}, {3.896952398064419*^9, 
   3.896952427744338*^9}, {3.89695246795844*^9, 3.8969525141578197`*^9}, {
   3.896952563942121*^9, 3.896952564418521*^9}, {3.8969525969150543`*^9, 
   3.8969526248559523`*^9}, {3.896952691226131*^9, 3.896952859895483*^9}, {
   3.8969528906293783`*^9, 3.896952950393342*^9}, {3.896953038141088*^9, 
   3.896953120642099*^9}, {3.896953846483046*^9, 3.8969538495630293`*^9}, {
   3.896954713034017*^9, 3.896954786334655*^9}, {3.8969548369834538`*^9, 
   3.8969549489342422`*^9}, {3.896954981696892*^9, 3.896954986088073*^9}, {
   3.896955196029868*^9, 3.896955222535067*^9}, 3.8969553045896378`*^9, {
   3.896955380516986*^9, 3.8969554093746843`*^9}, {3.896955443605876*^9, 
   3.8969554491416883`*^9}, {3.896955808932869*^9, 3.8969558311290703`*^9}, {
   3.896955906552322*^9, 3.896955933037631*^9}, {3.89695669778307*^9, 
   3.89695682344287*^9}, {3.8969568597233067`*^9, 3.8969568621854067`*^9}, {
   3.8969569198461437`*^9, 3.8969569281997557`*^9}, {3.8969570402534103`*^9, 
   3.896957040694272*^9}, {3.896957071453967*^9, 3.89695711828141*^9}, 
   3.896958565753355*^9, {3.8970369414819593`*^9, 3.8970369517312107`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"3e3ecdad-303d-434f-9796-eaf7ebbb6773"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]"}], 
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
     RowBox[{"h", "[", 
      RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
     SuperscriptBox[
      RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.896959829267824*^9, 3.8970203538284073`*^9, 3.8970320159631777`*^9, 
   3.897032163915744*^9, {3.897036933493881*^9, 3.897036952245824*^9}, 
   3.897112170559968*^9, 3.897112222222929*^9, 3.8975556216099854`*^9, 
   3.897634612920129*^9, 3.8976346612156267`*^9, 3.897635507149783*^9, 
   3.898590044198923*^9, 3.8986568235067177`*^9, 3.898664236068293*^9, 
   3.8986841049606333`*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"7e9dd6db-dd39-4360-aae5-7d6efea5a4ba"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]"}], 
  RowBox[{
   SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
   SuperscriptBox[
    RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.896959829267824*^9, 3.8970203538284073`*^9, 3.8970320159631777`*^9, 
   3.897032163915744*^9, {3.897036933493881*^9, 3.897036952245824*^9}, 
   3.897112170559968*^9, 3.897112222222929*^9, 3.8975556216099854`*^9, 
   3.897634612920129*^9, 3.8976346612156267`*^9, 3.897635507149783*^9, 
   3.898590044198923*^9, 3.8986568235067177`*^9, 3.898664236068293*^9, 
   3.898684104982211*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"fea29a7e-a36c-4dba-945f-69429a557782"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "parallel"}], "-", 
    RowBox[{
    "transported", " ", "spin", " ", "vector", " ", "can", " ", "than", " ", 
     "be", " ", "expressed", " ", "through", " ", "this", " ", "tetrad", " ", 
     "as"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SvecSol", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"sp", " ", "e\[Theta]"}], " ", "+", " ", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["s", "2"], "-", 
        SuperscriptBox["sp", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Psi]", "]"}], "er"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Psi]", "]"}], "e\[Phi]"}]}], ")"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.897037572683124*^9, 3.8970376467414083`*^9}, {
  3.897037940237897*^9, 3.897037944909327*^9}, {3.89865858455103*^9, 
  3.898658621243314*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"67a2876a-f9ab-4457-9bf2-0a5dd74919e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "-", "sp"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"s", "+", "sp"}], ")"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]]}]], "+", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           SuperscriptBox["\[ScriptCapitalE]", "2"], 
           RowBox[{"f", "[", 
            RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]], "-", 
          FractionBox[
           SuperscriptBox["\[ScriptCapitalJ]", "2"], 
           SuperscriptBox[
            RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]]}]], " ", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
           SuperscriptBox[
            RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]]}], ")"}]}], 
   ",", 
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s", "-", "sp"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"s", "+", "sp"}], ")"}]}]], " ", 
     RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]]}], 
    SuperscriptBox[
     RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "-", "sp"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"s", "+", "sp"}], ")"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ScriptCapitalJ]", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ScriptCapitalE]", "2"], " ", 
             SuperscriptBox[
              RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
               SuperscriptBox[
                RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]}], 
          RowBox[{"h", "[", 
           RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}]]]}], 
       RowBox[{"rt", "[", "\[Tau]", "]"}]], "+", 
      FractionBox[
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
         RowBox[{"h", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
           SuperscriptBox[
            RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]]]}], ")"}]}], 
   ",", 
   FractionBox["sp", 
    RowBox[{"rt", "[", "\[Tau]", "]"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.8970376765815697`*^9, 3.897037946221345*^9, 
  3.897112171574698*^9, 3.897112222865835*^9, 3.897555622636539*^9, 
  3.897634613984552*^9, 3.897634661996407*^9, 3.897635508207906*^9, 
  3.8985900452313337`*^9, 3.898656824548635*^9, 3.898664237155074*^9, 
  3.898684105942205*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"30ec4df5-785b-44ce-a3a2-c69e635365b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "With", " ", "the", " ", "use", " ", "of", " ", "the", " ", "precession", 
    " ", "angle", " ", "we", " ", "can", " ", "now", " ", "elegantly", " ", 
    "reexpress", " ", "\[Delta]\[CurlyTheta]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"f", "[", "r", "]"}], " ", 
           RowBox[{"h", "[", "r", "]"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"St", "[", "\[Tau]", "]"}]}], " ", 
            RowBox[{
             SuperscriptBox["rt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sr", "[", "\[Tau]", "]"}], " ", 
            RowBox[{
             SuperscriptBox["tt", "\[Prime]",
              MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}], 
        RowBox[{" ", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]t", "\[Prime]",
            MultilineFunction->None], "[", "\[Tau]", "]"}]}]}]], ")"}], "/.", 
      "TrRule"}], "/.", "LeadURule"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"St", "[", "\[Tau]", "]"}], "->", 
       RowBox[{"SvecSol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", 
      RowBox[{
       RowBox[{"Sr", "[", "\[Tau]", "]"}], "->", 
       RowBox[{"SvecSol", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "//", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"rt", "[", "\[Tau]", "]"}], ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalE]", ">", "0"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"rt", "[", "\[Tau]", "]"}], "]"}], ">", "0"}]}], "}"}]}], 
     "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.897046373087237*^9, 3.897046384859725*^9}, {
   3.897046430027377*^9, 3.897046572887672*^9}, 3.897636486918432*^9, {
   3.898658688318387*^9, 3.898658723732085*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"31870c69-715b-4431-ab63-abf28ff2f2c7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"s", "-", "sp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s", "+", "sp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], ")"}]}]], " ", 
   RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
  RowBox[{"\[ScriptCapitalJ]", " ", 
   RowBox[{"rt", "[", "\[Tau]", "]"}]}]]], "Output",
 CellChangeTimes->{{3.897046486156107*^9, 3.897046573691627*^9}, 
   3.897112172371689*^9, 3.897112223477252*^9, 3.897555623471023*^9, 
   3.897634614824477*^9, 3.897634662670024*^9, 3.897635509041504*^9, 
   3.897636487667454*^9, 3.898590046350205*^9, 3.898656825336331*^9, 
   3.89866423746768*^9, 3.898684106241932*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"18269e78-8f62-42f1-a277-39c28164b6ea"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Schwarzschild p,e parametrization", "Section",
 CellChangeTimes->{{3.8971177130906353`*^9, 3.8971177273195763`*^9}, {
  3.897194401249525*^9, 3.897194403060565*^9}, {3.898664608602283*^9, 
  3.8986646165037746`*^9}},ExpressionUUID->"5b819c66-de88-40f9-94ea-\
2b7b73fc7897"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Omitting", " ", "the", " ", 
     RowBox[{"1", "/", 
      RowBox[{"r", "^", "3"}]}]}], ",", " ", 
    RowBox[{
    "\[ScriptCapitalR]", " ", "is", " ", "a", " ", "cubic", " ", "in", " ", 
     "Schwarzschild"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Rpol", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"rt", "[", "\[Tau]", "]"}], "4"], "urint2"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
         FractionBox["sp", 
          RowBox[{"rt", "[", "\[Tau]", "]"}]]}], "}"}]}], "/.", "fhRule"}], "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{"Rpol", ",", 
      RowBox[{"rt", "[", "\[Tau]", "]"}]}], "]"}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"Rpol", ",", "sp"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", "->", "1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897102835433017*^9, 3.897102837916753*^9}, {
   3.897115053715169*^9, 3.897115147784685*^9}, {3.897115788445966*^9, 
   3.897115801418167*^9}, {3.89711586237955*^9, 3.897115917721497*^9}, {
   3.8971159576157312`*^9, 3.8971159702114773`*^9}, {3.897116300545128*^9, 
   3.89711632931131*^9}, {3.897191140184738*^9, 3.897191152953718*^9}, {
   3.897192519956683*^9, 3.8971925650601254`*^9}, 3.897286350215109*^9, {
   3.897553801395857*^9, 3.897553840786695*^9}, {3.8975606536326733`*^9, 
   3.89756067622298*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"4ca21be1-83cf-445f-afab-6f56ef3b6238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "M", " ", "\[ScriptCapitalJ]", " ", 
     RowBox[{"(", 
      RowBox[{"\[ScriptCapitalJ]", "-", 
       RowBox[{
       "3", " ", "sp", " ", "\[ScriptCapitalE]", " ", "\[Epsilon]"}]}], 
      ")"}]}], "-", 
    RowBox[{"\[ScriptCapitalJ]", " ", 
     RowBox[{"(", 
      RowBox[{"\[ScriptCapitalJ]", "-", 
       RowBox[{
       "2", " ", "sp", " ", "\[ScriptCapitalE]", " ", "\[Epsilon]"}]}], ")"}],
      " ", 
     RowBox[{"rt", "[", "\[Tau]", "]"}]}], "+", 
    RowBox[{"2", " ", "M", " ", 
     SuperscriptBox[
      RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"rt", "[", "\[Tau]", "]"}], "3"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.897191153293778*^9, 3.897194381268194*^9, 3.8972863516922483`*^9, {
   3.897553802748857*^9, 3.8975538411413803`*^9}, 3.897554813249263*^9, 
   3.897555623616744*^9, 3.897557625858824*^9, {3.897560664107498*^9, 
   3.897560677399727*^9}, 3.8976346149826097`*^9, 3.897634662822146*^9, 
   3.897635509195487*^9, 3.898590046526314*^9, 3.898656825516108*^9, 
   3.898664237507709*^9, 3.898684106281645*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"d22a109d-1655-4d95-95ba-f7fb4ba02bbb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"2", " ", "M", " ", "\[ScriptCapitalJ]", " ", 
    RowBox[{"(", 
     RowBox[{"\[ScriptCapitalJ]", "-", 
      RowBox[{"3", " ", "sp", " ", "\[ScriptCapitalE]", " ", "\[Epsilon]"}]}],
      ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "\[ScriptCapitalJ]"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[ScriptCapitalJ]", "-", 
      RowBox[{"2", " ", "sp", " ", "\[ScriptCapitalE]", " ", "\[Epsilon]"}]}],
      ")"}]}], ",", 
   RowBox[{"2", " ", "M"}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[ScriptCapitalE]", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.897191153293778*^9, 3.897194381268194*^9, 3.8972863516922483`*^9, {
   3.897553802748857*^9, 3.8975538411413803`*^9}, 3.897554813249263*^9, 
   3.897555623616744*^9, 3.897557625858824*^9, {3.897560664107498*^9, 
   3.897560677399727*^9}, 3.8976346149826097`*^9, 3.897634662822146*^9, 
   3.897635509195487*^9, 3.898590046526314*^9, 3.898656825516108*^9, 
   3.898664237507709*^9, 3.898684106300417*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"d34eda9d-3860-4d55-a2c0-fe3e55fbd3e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rt", "[", "\[Tau]", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", "M", " ", "\[ScriptCapitalE]", " ", 
     "\[ScriptCapitalJ]"}], "+", 
    RowBox[{"2", " ", "\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]", " ", 
     RowBox[{"rt", "[", "\[Tau]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.897191153293778*^9, 3.897194381268194*^9, 3.8972863516922483`*^9, {
   3.897553802748857*^9, 3.8975538411413803`*^9}, 3.897554813249263*^9, 
   3.897555623616744*^9, 3.897557625858824*^9, {3.897560664107498*^9, 
   3.897560677399727*^9}, 3.8976346149826097`*^9, 3.897634662822146*^9, 
   3.897635509195487*^9, 3.898590046526314*^9, 3.898656825516108*^9, 
   3.898664237507709*^9, 3.898684106318718*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"62ea1cbd-7bd7-4538-96dc-e9663809c838"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Solve", " ", "for", " ", "corrections", " ", "to", " ", "energy", " ", 
     "and", " ", "angular", " ", "momentum", " ", "relation", " ", "to", " ", 
     "eccentricity", " ", "e", " ", "and", " ", "semi"}], "-", 
    RowBox[{"latus", " ", "rectum", " ", "p"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EJRule", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalE]", " ", "->", 
        SqrtBox[
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", " ", "-", " ", 
               RowBox[{"2", "M"}]}], ")"}], "^", "2"}], " ", "-", " ", 
            RowBox[{"4", 
             RowBox[{"M", "^", "2"}], " ", 
             RowBox[{"e", "^", "2"}]}]}], 
           RowBox[{"p", 
            RowBox[{"(", 
             RowBox[{"p", " ", "-", " ", 
              RowBox[{"M", 
               RowBox[{"(", 
                RowBox[{"3", " ", "+", " ", 
                 RowBox[{"e", "^", "2"}]}], ")"}]}]}], ")"}]}]], "+", 
          RowBox[{"\[Epsilon]", " ", "dE"}]}]]}], ",", " ", 
       RowBox[{"\[ScriptCapitalJ]", " ", "->", " ", 
        SqrtBox[
         RowBox[{
          FractionBox[
           RowBox[{"M", " ", 
            RowBox[{"p", "^", "2"}]}], 
           RowBox[{"p", " ", "-", " ", 
            RowBox[{"M", 
             RowBox[{"(", 
              RowBox[{"3", " ", "+", 
               RowBox[{"e", "^", "2"}]}], ")"}]}]}]], "+", 
          RowBox[{"\[Epsilon]", " ", "dJ"}]}]]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"koef2", " ", "=", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ExpandAll", "[", "Rpol", "]"}], "/.", "EJRule"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rt", "[", "\[Tau]", "]"}], "->", 
            FractionBox["p", 
             RowBox[{"1", "+", "e"}]]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[Epsilon]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"koef1", " ", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ExpandAll", "[", "Rpol", "]"}], "/.", "EJRule"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rt", "[", "\[Tau]", "]"}], "->", 
            FractionBox["p", 
             RowBox[{"1", "-", "e"}]]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[Epsilon]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"dEdJRule", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"koef1", "==", "0"}], ",", 
          RowBox[{"koef2", "==", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"dE", ",", "dJ"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"3", "+", 
                 SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], ")"}]}], "+", 
            "p"}], ">", "0"}], ",", 
          RowBox[{"p", ">", "0"}]}], "}"}]}], "]"}], "&"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.897117184641844*^9, 3.8971172849209003`*^9}, {
  3.897117757527516*^9, 3.89711780105193*^9}, {3.897117845456586*^9, 
  3.897117889281123*^9}, {3.897118343314732*^9, 3.897118368318022*^9}, {
  3.897286404753091*^9, 3.897286407325397*^9}, {3.897556174970346*^9, 
  3.897556188941121*^9}, {3.897560757414723*^9, 3.8975608269225807`*^9}, {
  3.897560966099464*^9, 3.897560994755376*^9}, {3.8975611883602743`*^9, 
  3.897561264531146*^9}, {3.8975613389178534`*^9, 3.8975613566109657`*^9}, {
  3.897617798933399*^9, 3.897617835383758*^9}, {3.89866425780455*^9, 
  3.898664260744031*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"9610ae58-17c9-4f79-81ed-6f6084e56a31"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dE", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["e", "2"]}], ")"}], "2"], " ", 
       SuperscriptBox["M", 
        RowBox[{"3", "/", "2"}]], " ", 
       SqrtBox[
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["e", "2"]}], ")"}], " ", 
            SuperscriptBox["M", "2"]}], "-", 
           RowBox[{"4", " ", "M", " ", "p"}], "+", 
           SuperscriptBox["p", "2"]}], ")"}]}]], " ", "sp"}], 
      RowBox[{
       SuperscriptBox["p", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", 
               SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], ")"}]}], "+", 
          "p"}], ")"}], "2"]}]]}]}], ",", 
   RowBox[{"dJ", "\[Rule]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"M", " ", "p"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], "+", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["e", "2"]}], ")"}], " ", 
         SuperscriptBox["M", "2"]}], "-", 
        RowBox[{"4", " ", "M", " ", "p"}], "+", 
        SuperscriptBox["p", "2"]}]], " ", "sp"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "+", 
             SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], ")"}]}], "+", 
        "p"}], ")"}], "2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.89755618943818*^9, 3.897557637550935*^9, {3.897560787605296*^9, 
   3.897560827483387*^9}, 3.8975609956739893`*^9, {3.897561189564073*^9, 
   3.897561199980318*^9}, {3.897561255626899*^9, 3.897561265403738*^9}, 
   3.8975613572409363`*^9, 3.8976178371875267`*^9, 3.897634615995674*^9, 
   3.8976346632003*^9, 3.89763551007745*^9, 3.8985900474599237`*^9, 
   3.898656825959944*^9, 3.898664238309348*^9, 3.898684107181241*^9},
 CellLabel->
  "Out[177]=",ExpressionUUID->"ebc866ea-672d-4054-be6a-fb3d77e98bc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "solving", " ", "for", " ", "third", " ", "root", " ", "r3"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{"r1", " ", "-", " ", "r"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"r", "-", "r2"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"r", "-", "r3"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"r", "-", "r4"}], ")"}]}], ",", 
              SuperscriptBox["r", "2"]}], "]"}], "==", 
            RowBox[{"Coefficient", "[", 
             RowBox[{"Rpol", ",", 
              SuperscriptBox[
               RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}], "]"}]}], ",", 
           "r3"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptCapitalE]", " ", "->", 
            SqrtBox[
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p", " ", "-", " ", 
                   RowBox[{"2", "M"}]}], ")"}], "^", "2"}], " ", "-", " ", 
                RowBox[{"4", 
                 RowBox[{"M", "^", "2"}], " ", 
                 RowBox[{"e", "^", "2"}]}]}], 
               RowBox[{"p", 
                RowBox[{"(", 
                 RowBox[{"p", " ", "-", " ", 
                  RowBox[{"M", 
                   RowBox[{"(", 
                    RowBox[{"3", " ", "+", " ", 
                    RowBox[{"e", "^", "2"}]}], ")"}]}]}], ")"}]}]], "+", 
              RowBox[{"\[Epsilon]", " ", "dE"}]}]]}], ",", " ", 
           RowBox[{"\[ScriptCapitalJ]", " ", "->", " ", 
            SqrtBox[
             RowBox[{
              FractionBox[
               RowBox[{"M", " ", 
                RowBox[{"p", "^", "2"}]}], 
               RowBox[{"p", " ", "-", " ", 
                RowBox[{"M", 
                 RowBox[{"(", 
                  RowBox[{"3", " ", "+", 
                   RowBox[{"e", "^", "2"}]}], ")"}]}]}]], "+", 
              RowBox[{"\[Epsilon]", " ", "dJ"}]}]]}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "->", 
           RowBox[{"p", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "e"}], ")"}]}]}], ",", 
          RowBox[{"r2", "->", 
           RowBox[{"p", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", "e"}], ")"}]}]}], ",", 
          RowBox[{"r4", "->", "0"}], ",", 
          RowBox[{"\[Epsilon]", "->", "1"}]}], "}"}]}], "/.", "dEdJRule"}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"r3", "/.", "#"}], ",", 
         RowBox[{"{", 
          RowBox[{"sp", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}]}], "//", 
     "Simplify"}], ")"}], "//", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", 
               SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], ")"}]}], "+", 
          "p"}], ">", "0"}], ",", 
        RowBox[{"p", ">", "0"}], ",", 
        RowBox[{"M", ">", "0"}]}], "}"}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.897192608202134*^9, 3.897192628421733*^9}, {
   3.897286181183247*^9, 3.897286185208969*^9}, {3.897286246625692*^9, 
   3.897286255200138*^9}, {3.897286459671075*^9, 3.897286469447299*^9}, {
   3.897286529214019*^9, 3.8972865319262877`*^9}, 3.897556847988018*^9, {
   3.897558721373784*^9, 3.8975587793784523`*^9}, {3.897558810095105*^9, 
   3.897558838896318*^9}, {3.89755887512685*^9, 3.897558982913619*^9}, {
   3.897561366916827*^9, 3.897561368825329*^9}, {3.897561453109439*^9, 
   3.8975614783966093`*^9}, 3.897561560765766*^9, {3.897561608894546*^9, 
   3.89756161736292*^9}, {3.897617172926272*^9, 3.897617177192017*^9}, {
   3.897619028544907*^9, 3.897619031084886*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"b6af78ae-864f-459a-b34a-b8c78d89eb52"],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"M", " ", "p"}], ")"}]}], 
      RowBox[{
       RowBox[{"4", " ", "M"}], "-", "p"}]]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "p", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["M", "3"], " ", "p", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["e", "2"]}], ")"}], " ", 
              SuperscriptBox["M", "2"]}], "-", 
             RowBox[{"4", " ", "M", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}], ")"}]}]]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           SuperscriptBox["e", "2"]}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["M", "5"], " ", "p", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["e", "2"]}], ")"}], " ", 
              SuperscriptBox["M", "2"]}], "-", 
             RowBox[{"4", " ", "M", " ", "p"}], "+", 
             SuperscriptBox["p", "2"]}], ")"}]}]]}]}], ")"}], " ", "sp"}], 
     RowBox[{"M", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", 
           SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], "-", "p"}], ")"}], 
      " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "M"}], "+", "p"}], ")"}], "2"]}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "sp", "]"}], "2"],
     SeriesData[$CellContext`sp, 0, {}, 0, 2, 1],
     Editable->False]}],
   SeriesData[$CellContext`sp, 
    0, {(-2) $CellContext`M (
       4 $CellContext`M - $CellContext`p)^(-1) $CellContext`p, \
$CellContext`M^(-1) ((
         3 + $CellContext`e^2) $CellContext`M - $CellContext`p)^(-1) ((-4) \
$CellContext`M + $CellContext`p)^(-2) (
      2 $CellContext`p ($CellContext`M^3 $CellContext`p ((-4) (-1 + \
$CellContext`e^2) $CellContext`M^2 - 
          4 $CellContext`M $CellContext`p + $CellContext`p^2))^Rational[1, 2] - 
      2 (3 + $CellContext`e^2) ($CellContext`M^5 $CellContext`p ((-4) (-1 + \
$CellContext`e^2) $CellContext`M^2 - 
         4 $CellContext`M $CellContext`p + $CellContext`p^2))^
       Rational[1, 2])}, 0, 2, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{
  3.897194381695264*^9, 3.897286192389841*^9, 3.897286256829612*^9, {
   3.897286523957623*^9, 3.897286532687793*^9}, 3.8975556240915003`*^9, 
   3.897556854107267*^9, 3.8975587269184017`*^9, 3.8975587822808437`*^9, {
   3.897558910193919*^9, 3.897558929582708*^9}, 3.897558983910033*^9, 
   3.897561370705304*^9, 3.897561461325738*^9, {3.897561536335555*^9, 
   3.897561563569214*^9}, 3.89756161159654*^9, 3.897617178763835*^9, 
   3.897619034035741*^9, 3.897634617293997*^9, 3.897634663321216*^9, 
   3.897635511291*^9, 3.89859004878689*^9, 3.898656826524188*^9, 
   3.898664238898409*^9, 3.898684108503212*^9},
 CellLabel->
  "Out[178]=",ExpressionUUID->"dc1dffb8-5065-466e-90f3-227750b30b06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "LSO", " ", "condition", " ", "around", " ", "p"}], 
    "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"6", "+", 
       RowBox[{"2", "e"}]}], ")"}], "M"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Jac", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptCapitalE]", "/.", "EJRule"}], "/.", "dEdJRule"}],
            ",", "p"}], "]"}], ",", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptCapitalE]", "/.", "EJRule"}], "/.", "dEdJRule"}],
            ",", "e"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptCapitalJ]", "/.", "EJRule"}], "/.", "dEdJRule"}],
            ",", "p"}], "]"}], ",", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptCapitalJ]", "/.", "EJRule"}], "/.", "dEdJRule"}],
            ",", "e"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"JacCoef", " ", "=", 
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Det", "[", "Jac", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "->", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"6", "+", 
                  RowBox[{"2", "e"}]}], ")"}], "M"}], " ", "+", " ", 
               RowBox[{"sp", " ", "dp"}]}]}], ",", 
             RowBox[{"\[Epsilon]", "->", "1"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"sp", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
        "FullSimplify"}], "//", "Normal"}], ",", "sp"}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.897117368177498*^9, 3.897117368178729*^9}, {
   3.897117426554305*^9, 3.897117433210341*^9}, {3.897117467593924*^9, 
   3.897117592689126*^9}, {3.897119182600113*^9, 3.897119196427575*^9}, {
   3.8971926483711348`*^9, 3.897192648790222*^9}, {3.8971930594432297`*^9, 
   3.897193107609737*^9}, {3.897193169045827*^9, 3.897193181056305*^9}, {
   3.8971932352589273`*^9, 3.897193290615983*^9}, 3.897193388136936*^9, {
   3.8971945308048573`*^9, 3.8971945485795927`*^9}, {3.897556912850092*^9, 
   3.897556920232748*^9}, {3.89763668353841*^9, 3.8976367270299883`*^9}, {
   3.8976368161387444`*^9, 3.897636842381164*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"fa375f26-e35d-47ed-81c9-f8bc59dcc98e"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "e"}], ")"}], " ", 
      SuperscriptBox["M", 
       RowBox[{"5", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox["2"], " ", "dp", " ", "e", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "9"}], "+", 
           SuperscriptBox["e", "2"]}], ")"}], " ", 
         SuperscriptBox["M", 
          RowBox[{"3", "/", "2"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "e"}], ")"}], " ", 
           SuperscriptBox["M", "2"]}]]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "e"}], ")"}], "2"]}], " ", 
            SuperscriptBox["M", 
             RowBox[{"3", "/", "2"}]], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"3", "+", "e"}], ")"}], " ", 
              SuperscriptBox["M", "2"]}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "e"}], ")"}], "2"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "e"}], ")"}], " ", 
              SuperscriptBox["M", "2"]}]], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "e"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", "e"}], ")"}], " ", 
              SuperscriptBox["M", "3"]}]]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", "e"}], ")"}], "5"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "e"}], ")"}], "3"], " ", 
      SqrtBox[
       FractionBox["1", 
        RowBox[{"9", "-", 
         SuperscriptBox["e", "2"]}]]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "e"}], ")"}], " ", 
         SuperscriptBox["M", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"3", "+", "e"}], ")"}], "2"], " ", 
           SuperscriptBox["M", "2"]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "e"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "e"}], ")"}]}]]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8971174336272707`*^9, 3.897117531284346*^9, {3.897117587733539*^9, 
   3.897117592992592*^9}, 3.8971931599953747`*^9, 3.897193195276595*^9, {
   3.89719327473182*^9, 3.897193300109424*^9}, 3.897194382207094*^9, 
   3.8975556332791862`*^9, 3.8975569332374477`*^9, 3.897634626642412*^9, 
   3.8976346645572367`*^9, 3.8976355132281303`*^9, 3.897636743161347*^9, {
   3.897636846570676*^9, 3.8976368468036222`*^9}, 3.898590061936763*^9, 
   3.8986568298383837`*^9, 3.898664241822608*^9, 3.89868412148006*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"261948ea-74e3-4670-bc5c-5826ea447f99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "solve", " ", "for", " ", "the", " ", "correction", " ", "dp", 
    " ", "for", " ", "LSO"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"JacCoef", "==", "0"}], ",", "dp"}], "]"}], "//", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "<", "e", "<", "1"}], ",", 
        RowBox[{"M", ">", "0"}]}], "}"}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.897117607931772*^9, 3.897117638920331*^9}, {
   3.897193316457534*^9, 3.8971934008834333`*^9}, {3.897194518652865*^9, 
   3.897194521396351*^9}, 3.897556974675953*^9, {3.897636755316655*^9, 
   3.897636755829154*^9}, {3.897636852587675*^9, 3.897636853117206*^9}, {
   3.898664335773204*^9, 3.898664337195326*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"668f2032-1387-4835-993e-61cda46ebaab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"dp", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "e"}], ")"}]}], 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "e"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "e"}], ")"}]}]]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.897117617261269*^9, 3.8971176392678757`*^9}, 
   3.8971933217340937`*^9, {3.897193359332219*^9, 3.897193365835136*^9}, 
   3.8971943822427483`*^9, 3.897555633376911*^9, 3.897556984678419*^9, 
   3.8976346267338257`*^9, 3.897634664632208*^9, 3.897635513318139*^9, 
   3.8976367570597677`*^9, 3.897636853817618*^9, 3.8985900620650787`*^9, 
   3.8986568299401484`*^9, 3.898664241927392*^9, 3.898684121587031*^9},
 CellLabel->
  "Out[181]=",ExpressionUUID->"0cdbd7de-d37b-438c-bcf2-1b37c2682d55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Expressions", " ", "for", " ", "Mino", " ", "velocities", " ", "of", " ",
      "t"}], ",", 
    RowBox[{"\[Phi]", " ", "DOF"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "utint"}], "/.", "fhRule"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
          RowBox[{"sp", "/", "r"}]}], ",", 
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], "->", "r"}]}], "}"}]}], ",", 
      "\[Epsilon]"}], "]"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "u\[Phi]int"}], "/.", "fhRule"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
          RowBox[{"sp", "/", "r"}]}], ",", 
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], "->", "r"}]}], "}"}]}], ",", 
      "\[Epsilon]"}], "]"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\[ScriptCapitalE]", " ", "\[ScriptCapitalJ]"}], 
           RowBox[{
            SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
            SuperscriptBox[
             RowBox[{"rt", "[", "\[Tau]", "]"}], "2"]}]], ")"}]}], "/.", 
        "fhRule"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"S\[Theta]", "[", "\[Tau]", "]"}], "->", 
          RowBox[{"sp", "/", "r"}]}], ",", 
         RowBox[{
          RowBox[{"rt", "[", "\[Tau]", "]"}], "->", "r"}]}], "}"}]}], ",", 
      "\[Epsilon]"}], "]"}], "//", "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.897288515924809*^9, 3.8972885561230516`*^9}, {
  3.897288592364731*^9, 3.8972886472461023`*^9}, {3.897288735868917*^9, 
  3.897288750149014*^9}, {3.897376389379676*^9, 3.897376390129863*^9}, {
  3.897380305752982*^9, 3.8973803229909143`*^9}, {3.897381482622834*^9, 
  3.897381484194475*^9}, {3.898664374305336*^9, 3.8986643897863894`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"306f2f49-e9f1-4a57-9cb6-7e83df56d3c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]"}], 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}]]}], ",", 
   FractionBox[
    RowBox[{"M", " ", "sp", " ", "\[ScriptCapitalJ]"}], 
    RowBox[{
     RowBox[{"2", " ", "M"}], "-", "r"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8972885410541677`*^9, 3.897288556451263*^9}, {
   3.897288636742251*^9, 3.8972886486120567`*^9}, 3.897288750864643*^9, 
   3.8973763907648478`*^9, 3.897381485900559*^9, 3.897555633410172*^9, 
   3.897557050229506*^9, 3.897634626776321*^9, 3.897634664674141*^9, 
   3.8976355133610163`*^9, 3.898590062120778*^9, 3.898656829986945*^9, 
   3.898664241976198*^9, 3.89868412162541*^9},
 CellLabel->
  "Out[182]=",ExpressionUUID->"46e5ed99-6ac6-4b95-94d3-b3495ac84c2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[ScriptCapitalJ]", ",", 
   RowBox[{
    RowBox[{"-", "sp"}], " ", "\[ScriptCapitalE]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8972885410541677`*^9, 3.897288556451263*^9}, {
   3.897288636742251*^9, 3.8972886486120567`*^9}, 3.897288750864643*^9, 
   3.8973763907648478`*^9, 3.897381485900559*^9, 3.897555633410172*^9, 
   3.897557050229506*^9, 3.897634626776321*^9, 3.897634664674141*^9, 
   3.8976355133610163`*^9, 3.898590062120778*^9, 3.898656829986945*^9, 
   3.898664241976198*^9, 3.898684121642146*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"80a00b74-3f5e-4190-b2a7-4cd295bd1866"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "2"], " ", "\[ScriptCapitalE]", " ", 
    "\[ScriptCapitalJ]"}], 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["\[ScriptCapitalJ]", "2"]}]], "}"}]], "Output",
 CellChangeTimes->{{3.8972885410541677`*^9, 3.897288556451263*^9}, {
   3.897288636742251*^9, 3.8972886486120567`*^9}, 3.897288750864643*^9, 
   3.8973763907648478`*^9, 3.897381485900559*^9, 3.897555633410172*^9, 
   3.897557050229506*^9, 3.897634626776321*^9, 3.897634664674141*^9, 
   3.8976355133610163`*^9, 3.898590062120778*^9, 3.898656829986945*^9, 
   3.898664241976198*^9, 3.8986841216580763`*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"01a203a7-ac60-4a21-b027-88f12bf10c9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Deriving", " ", "a", " ", "simpler", " ", "expression", " ", "for", " ", 
    "dr3"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"EQN", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Rpol", "/.", "EJRule"}], "/.", "dEdJRule"}], " ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rt", "[", "\[Tau]", "]"}], "->", "r"}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"r", "->", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "M", " ", "p"}], 
            RowBox[{"p", "-", 
             RowBox[{"4", "M"}]}]], " ", "+", " ", 
           RowBox[{"\[Epsilon]", " ", "dr3"}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "//", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", ">", 
           RowBox[{"6", "M"}], ">", "0"}], ",", 
          RowBox[{"0", "<", "e", "<", "1"}]}], "}"}]}], "]"}], "&"}]}], "//", 
    
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"#", ",", "\[Epsilon]"}], "]"}], "&"}]}]}]}]], "Input",
 CellChangeTimes->{{3.89761877784833*^9, 3.897618938704274*^9}, {
  3.897618971679853*^9, 3.897618986567041*^9}, {3.897619085807642*^9, 
  3.897619162559011*^9}, {3.897619201566918*^9, 3.897619208048202*^9}, {
  3.897619459787477*^9, 3.89761952353684*^9}, {3.897619560324441*^9, 
  3.897619573552999*^9}, {3.8986645374272633`*^9, 3.8986645542291927`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"9d52883b-f36c-458b-b829-6157f9775d1d"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["M", "2"], " ", 
      SuperscriptBox["p", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dr3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", "e"}], ")"}], " ", "M"}], "-", "p"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], "-", "p"}], 
          ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], " ", "M"}], "+", "p"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "e"}], ")"}], " ", "M"}], "+", "p"}], 
          ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "108"}], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["M", "7"], " ", "p", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["e", "2"]}], ")"}], " ", 
                 SuperscriptBox["M", "2"]}], "-", 
                RowBox[{"4", " ", "M", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}], ")"}]}]]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["e", "4"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["M", "7"], " ", "p", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["e", "2"]}], ")"}], " ", 
                 SuperscriptBox["M", "2"]}], "-", 
                RowBox[{"4", " ", "M", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}], ")"}]}]]}], "+", 
           RowBox[{"72", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["M", "5"], " ", 
              SuperscriptBox["p", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["e", "2"]}], ")"}], " ", 
                 SuperscriptBox["M", "2"]}], "-", 
                RowBox[{"4", " ", "M", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}], ")"}]}]]}], "-", 
           RowBox[{"15", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["M", "3"], " ", 
              SuperscriptBox["p", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["e", "2"]}], ")"}], " ", 
                 SuperscriptBox["M", "2"]}], "-", 
                RowBox[{"4", " ", "M", " ", "p"}], "+", 
                SuperscriptBox["p", "2"]}], ")"}]}]]}], "+", 
           SqrtBox[
            RowBox[{"M", " ", 
             SuperscriptBox["p", "7"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["e", "2"]}], ")"}], " ", 
                SuperscriptBox["M", "2"]}], "-", 
               RowBox[{"4", " ", "M", " ", "p"}], "+", 
               SuperscriptBox["p", "2"]}], ")"}]}]], "-", 
           RowBox[{
            SuperscriptBox["e", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"24", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["M", "7"], " ", "p", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["e", "2"]}], ")"}], " ", 
                    SuperscriptBox["M", "2"]}], "-", 
                   RowBox[{"4", " ", "M", " ", "p"}], "+", 
                   SuperscriptBox["p", "2"]}], ")"}]}]]}], "-", 
              RowBox[{"8", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["M", "5"], " ", 
                 SuperscriptBox["p", "3"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["e", "2"]}], ")"}], " ", 
                    SuperscriptBox["M", "2"]}], "-", 
                   RowBox[{"4", " ", "M", " ", "p"}], "+", 
                   SuperscriptBox["p", "2"]}], ")"}]}]]}], "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["M", "3"], " ", 
                SuperscriptBox["p", "5"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "4"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["e", "2"]}], ")"}], " ", 
                   SuperscriptBox["M", "2"]}], "-", 
                  RowBox[{"4", " ", "M", " ", "p"}], "+", 
                  SuperscriptBox["p", "2"]}], ")"}]}]]}], ")"}]}]}], ")"}], 
         " ", "sp"}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "M"}], "+", "p"}], ")"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              SuperscriptBox["e", "2"]}], ")"}], " ", "M"}], ")"}]}], "+", 
         "p"}], ")"}], "2"]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.897619506659773*^9, 3.897619527354055*^9}, {
   3.897619573837747*^9, 3.897619574170179*^9}, 3.897634632187223*^9, 
   3.897634667422564*^9, 3.8976355189893303`*^9, 3.89859006790991*^9, 
   3.8986568349063177`*^9, 3.898664247530348*^9, 3.898684124940192*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"960ed2d5-e71f-4548-9a34-0f77a3f9cbed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dr3", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"EQN", "/.", 
          RowBox[{"{", 
           RowBox[{"M", "->", "1"}], "}"}]}], ")"}], "==", "0"}], ",", 
       "dr3"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "//", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", ">", "0"}], ",", 
       RowBox[{"0", "<", "e", "<", "1"}]}], "}"}]}], "]"}], "&"}]}]], "Input",\

 CellChangeTimes->{{3.897619606822247*^9, 3.897619648482383*^9}, {
  3.897619758152063*^9, 3.89761987400753*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"275c86fc-2801-47d6-a9b2-26ba9105707b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SuperscriptBox["e", "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "p"}], ")"}], "2"]}], ")"}], " ", "p"}]], 
    " ", "sp"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", "p"}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.897619619427821*^9, 3.897619648952921*^9}, {
   3.897619758817997*^9, 3.8976198194039173`*^9}, {3.897619851514433*^9, 
   3.8976198754997587`*^9}, 3.8976346323432217`*^9, 3.897634667547497*^9, 
   3.8976355191474648`*^9, 3.898590068096547*^9, 3.898656835063192*^9, 
   3.898664247681353*^9, 3.8986841251127453`*^9},
 CellLabel->
  "Out[186]=",ExpressionUUID->"28476f13-8072-4d03-9369-a48d9823c48b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rootsRule", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r1", "->", 
      FractionBox["p", 
       RowBox[{"1", "-", "e"}]]}], ",", 
     RowBox[{"r2", "->", 
      FractionBox["p", 
       RowBox[{"1", "+", "e"}]]}], ",", 
     RowBox[{"r3", "->", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "M", " ", "p"}], 
        RowBox[{"p", "-", 
         RowBox[{"4", " ", "M"}]}]], "-", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              SuperscriptBox["e", "2"]}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "p"}], ")"}], "2"]}], ")"}], " ", 
           "p"}]], " ", "sp"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "p"}], ")"}], "2"]]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.897623971483179*^9, 3.897624030557611*^9}, {
  3.897624070898918*^9, 3.897624084144599*^9}, {3.897624267328423*^9, 
  3.897624275713868*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"13030f5e-46b3-4a92-a3f7-eceec43a281a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Elliptic integral expansion", "Section",
 CellChangeTimes->{{3.898664628360124*^9, 
  3.8986646743892603`*^9}},ExpressionUUID->"6478f18a-954e-4ae9-bc84-\
2febb6b52087"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "elliptic", " ", "integrals", " ", "were", " ", "computed", 
     " ", "in", " ", "Maple"}], ",", " ", 
    RowBox[{
     RowBox[{"since", " ", "it", " ", "has", " ", "better", " ", "elliptic"}],
      "-", 
     RowBox[{"integral", " ", 
      RowBox[{"algorithms", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "the", " ", "Mino", " ", "frequencies"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.897624139208727*^9, 3.8976243206129208`*^9}, {
   3.8976243540896187`*^9, 3.897624370181075*^9}, {3.897624636252551*^9, 
   3.897624684944442*^9}, {3.8976247460427513`*^9, 3.897624751195285*^9}, {
   3.897632711533084*^9, 3.897632725211171*^9}, {3.89866808551103*^9, 
   3.898668094661172*^9}, {3.8986681401522818`*^9, 3.898668176782159*^9}, 
   3.898668366192877*^9, 3.898669070105049*^9, {3.898669202456049*^9, 
   3.898669232381185*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"3dd05f46-001d-4205-8bfa-986ea5061dc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Radial", " ", "frequency"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalUpsilon]r", " ", "=", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Pi]", 
              FractionBox[
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"r1", " ", "-", " ", "r3"}], ")"}], "r2"}]], 
               RowBox[{"2", " ", 
                RowBox[{"EllipticK", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"r1", " ", "-", " ", "r2"}], ")"}], "r3"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"r1", "-", "r3"}], ")"}], "r2"}]], "]"}]}]]}], "/.",
              "EJRule"}], "/.", "dEdJRule"}], "/.", "rootsRule"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "->", "1"}], ",", 
            RowBox[{"\[Epsilon]", "->", "1"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"sp", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p", ">", "0"}], ",", 
           RowBox[{"0", "<", "e", "<", "1"}]}], "}"}]}], "]"}], "&"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Delta]\[CapitalUpsilon]r", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"\[CapitalUpsilon]r", ",", "sp"}], "]"}], "//", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"0", "<", "e", "<", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], "+", 
              RowBox[{"2", " ", "e"}], "+", "p"}], ">", "0"}]}], "}"}]}], 
         "]"}], "&"}]}], "//", "FunctionExpand"}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897624139208727*^9, 3.8976243206129208`*^9}, {
   3.8976243540896187`*^9, 3.897624370181075*^9}, {3.897624636252551*^9, 
   3.897624684944442*^9}, {3.8976247460427513`*^9, 3.897624751195285*^9}, {
   3.897632711533084*^9, 3.897632725211171*^9}, {3.89866808551103*^9, 
   3.898668094661172*^9}, {3.8986681401522818`*^9, 3.898668176782159*^9}, 
   3.898668366192877*^9, {3.898669070105049*^9, 3.898669080507587*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"d08af839-55d6-489e-baca-273a167855bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      RowBox[{"2", " ", "e"}], "+", "p"}]], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", "e"}], "-", "p"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", "e"}], "+", "p"}], ")"}]}], 
      RowBox[{"3", "+", 
       SuperscriptBox["e", "2"], "-", "p"}]]], " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "-", 
         SuperscriptBox["e", "2"], "+", "p"}], ")"}], " ", 
       RowBox[{"EllipticE", "[", 
        FractionBox[
         RowBox[{"4", " ", "e"}], 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          RowBox[{"2", " ", "e"}], "+", "p"}]], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"6", "+", 
         RowBox[{"2", " ", "e"}], "-", "p"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "+", 
         SuperscriptBox["e", "2"], "+", "p"}], ")"}], " ", 
       RowBox[{"EllipticK", "[", 
        FractionBox[
         RowBox[{"4", " ", "e"}], 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          RowBox[{"2", " ", "e"}], "+", "p"}]], "]"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{"6", "+", 
      RowBox[{"2", " ", "e"}], "-", "p"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      SuperscriptBox["e", "2"], "-", "p"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"EllipticK", "[", 
      FractionBox[
       RowBox[{"4", " ", "e"}], 
       RowBox[{
        RowBox[{"-", "6"}], "+", 
        RowBox[{"2", " ", "e"}], "+", "p"}]], "]"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.898668377296352*^9, 3.898684127276824*^9},
 CellLabel->
  "Out[190]=",ExpressionUUID->"c92e53a7-6992-4ec7-a20e-bde597b43d19"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Time", " ", "\"\<frequency\>\""}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"\[CapitalUpsilon]t", " ", "=", " ", "\[ScriptCapitalE]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.897624139208727*^9, 3.8976243206129208`*^9}, {
   3.8976243540896187`*^9, 3.897624370181075*^9}, {3.897624636252551*^9, 
   3.897624684944442*^9}, {3.8976247460427513`*^9, 3.897624751195285*^9}, {
   3.897632711533084*^9, 3.897632725211171*^9}, {3.89866808551103*^9, 
   3.898668094661172*^9}, {3.8986681401522818`*^9, 3.898668238347035*^9}, 
   3.8986683722334557`*^9, {3.8986690834343433`*^9, 3.898669108828233*^9}, {
   3.8986691910128107`*^9, 3.8986691967851677`*^9}, {3.898669302358197*^9, 
   3.8986693170558*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"036eedac-fe86-4a47-af70-d7a36e9a7106"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Azimuthal", " ", "frequency"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalUpsilon]\[Phi]", " ", "=", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[ScriptCapitalJ]", "-", 
               RowBox[{"sp", " ", "\[ScriptCapitalE]"}]}], ")"}], "/.", 
             "EJRule"}], "/.", "dEdJRule"}], "/.", "rootsRule"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "->", "1"}], ",", 
            RowBox[{"\[Epsilon]", "->", "1"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"sp", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p", ">", "0"}], ",", 
           RowBox[{"0", "<", "e", "<", "1"}]}], "}"}]}], "]"}], "&"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Delta]\[CapitalUpsilon]\[Phi]", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"\[CapitalUpsilon]\[Phi]", ",", "sp"}], "]"}], "//", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"0", "<", "e", "<", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], "+", 
              RowBox[{"2", " ", "e"}], "+", "p"}], ">", "0"}]}], "}"}]}], 
         "]"}], "&"}]}], "//", "FunctionExpand"}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897624139208727*^9, 3.8976243206129208`*^9}, {
   3.8976243540896187`*^9, 3.897624370181075*^9}, {3.897624636252551*^9, 
   3.897624684944442*^9}, {3.8976247460427513`*^9, 3.897624751195285*^9}, {
   3.897632711533084*^9, 3.897632725211171*^9}, {3.89866808551103*^9, 
   3.898668094661172*^9}, {3.8986681401522818`*^9, 3.898668238347035*^9}, 
   3.8986683722334557`*^9, {3.8986690834343433`*^9, 3.898669095292756*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"ebafa545-915a-40e7-9580-bdddb2293d3b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3", "+", 
      SuperscriptBox["e", "2"]}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      FractionBox[
       RowBox[{"4", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["e", "2"]}]}], "p"], "+", "p"}]]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "-", 
       SuperscriptBox["e", "2"], "+", "p"}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.898668374686607*^9, 3.898684128947383*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"d848ac43-515f-4b41-bd30-fac6b91d557b"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{2560, 1387},
WindowMargins->{{1352, Automatic}, {0, Automatic}},
Magnification->1.25,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8d9b9cb6-9be6-495c-b5c0-65525cbf1cca"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 249, 6, 123, "Title",ExpressionUUID->"66b2ecea-b430-453a-a3c6-cbc44d55d7b9"],
Cell[832, 30, 936, 15, 73, "Text",ExpressionUUID->"6c3a4c55-95b0-4a5d-b4c8-c61cf681604a"],
Cell[CellGroupData[{
Cell[1793, 49, 244, 4, 84, "Section",ExpressionUUID->"e8e02dbe-f151-4993-a0b6-8c9a41ec76f7"],
Cell[2040, 55, 7879, 210, 454, "Input",ExpressionUUID->"9a203dc2-7d6b-4f01-82bf-5a0438d7999b"],
Cell[9922, 267, 4515, 123, 376, "Input",ExpressionUUID->"cad8aa8e-71c6-4f38-9453-4e14a851686e"]
}, Closed]],
Cell[CellGroupData[{
Cell[14474, 395, 159, 3, 65, "Section",ExpressionUUID->"8d53d2e3-4d2d-4fb7-9ec8-f7636cb4010d"],
Cell[14636, 400, 273, 5, 37, "Input",ExpressionUUID->"67300c36-f5ac-4153-a131-fb5cf4f192cd"],
Cell[CellGroupData[{
Cell[14934, 409, 5697, 153, 676, "Input",ExpressionUUID->"4b2cc0af-bc5f-49d8-8501-ae5001762b5e"],
Cell[20634, 564, 1137, 22, 70, "Output",ExpressionUUID->"3190f6a8-2df2-40aa-88fc-1b7f8930385e"],
Cell[21774, 588, 1138, 22, 70, "Output",ExpressionUUID->"0dbf1000-713f-4ae5-bd19-c1517979ba60"],
Cell[22915, 612, 1140, 22, 70, "Output",ExpressionUUID->"ed33f439-fa62-4292-89bc-9ac1868ff5c9"],
Cell[24058, 636, 1138, 22, 70, "Output",ExpressionUUID->"87d79013-3d93-4fd5-9e6c-1e936a10a6d4"],
Cell[25199, 660, 1446, 33, 70, "Output",ExpressionUUID->"86f9fb4f-5b08-4d82-b5ff-eac0cfa7f8ab"],
Cell[26648, 695, 2032, 49, 70, "Output",ExpressionUUID->"4ed70f75-02eb-4e18-8f40-e4f342b8845c"],
Cell[28683, 746, 2030, 49, 70, "Output",ExpressionUUID->"7fc7360f-4c08-45e5-9f67-cfd44cbe8b33"],
Cell[30716, 797, 1689, 41, 70, "Output",ExpressionUUID->"a6537b8b-2dd8-4140-a301-c2db6c28d849"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[32454, 844, 176, 3, 65, "Section",ExpressionUUID->"dedcc5ec-489b-4ef0-aa4b-dbb02f42656f"],
Cell[32633, 849, 4600, 118, 310, "Input",ExpressionUUID->"b6fa96fc-d000-4190-80dc-03fc9501dc95"],
Cell[CellGroupData[{
Cell[37258, 971, 3163, 76, 168, "Input",ExpressionUUID->"cc90965d-ac37-4cd2-827d-80b74fff7db3"],
Cell[40424, 1049, 7916, 231, 199, "Output",ExpressionUUID->"46d4a6dc-155c-430b-abb3-fc4e176df533"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48377, 1285, 3743, 103, 184, "Input",ExpressionUUID->"2a4ffba7-bb72-42cb-a23e-fb918cffb3b6"],
Cell[52123, 1390, 492, 9, 42, "Output",ExpressionUUID->"bb261d7f-edaf-44e8-b850-f117dd64f903"],
Cell[52618, 1401, 492, 9, 42, "Output",ExpressionUUID->"da555b6e-dcf1-4436-af6e-c886fec40277"]
}, Open  ]],
Cell[53125, 1413, 3925, 100, 138, "Input",ExpressionUUID->"1b963e1d-919a-4ca8-8d6a-bdb5811e76c0"]
}, Closed]],
Cell[CellGroupData[{
Cell[57087, 1518, 166, 3, 65, "Section",ExpressionUUID->"76946252-83fb-4288-866a-371bbe58976e"],
Cell[CellGroupData[{
Cell[57278, 1525, 5156, 142, 216, "Input",ExpressionUUID->"0161c64f-fadd-4408-8797-e23557b25c18"],
Cell[62437, 1669, 1566, 40, 69, "Output",ExpressionUUID->"e8883236-8f33-404b-9edc-ca293f2a5c93"],
Cell[64006, 1711, 3471, 87, 69, "Output",ExpressionUUID->"bd5b16b7-2a20-44b4-8545-d065d1a677d6"],
Cell[67480, 1800, 3372, 89, 65, "Output",ExpressionUUID->"8e67c7db-2c4a-42e1-8dad-079d91a6c4c3"],
Cell[70855, 1891, 2159, 57, 67, "Output",ExpressionUUID->"31d5c392-086b-4734-a9e5-b4453899a5a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73051, 1953, 2432, 67, 142, "Input",ExpressionUUID->"2bf91785-eef0-4168-beea-00b0fe02527b"],
Cell[75486, 2022, 854, 16, 42, "Output",ExpressionUUID->"d3147e7d-33c2-49a8-903b-6e406fbaf6fd"],
Cell[76343, 2040, 856, 16, 42, "Output",ExpressionUUID->"f8ca3ede-2fc2-44c9-866e-0702ae299289"],
Cell[77202, 2058, 854, 16, 42, "Output",ExpressionUUID->"4fee50b7-bd30-4fd4-9c4c-afbf64129d8f"],
Cell[78059, 2076, 856, 16, 42, "Output",ExpressionUUID->"6caaeb04-822b-43f3-98b4-6fab1ebb6474"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78952, 2097, 3043, 84, 116, "Input",ExpressionUUID->"fcb4e0ab-ac66-4209-ae8b-d18caee3d3f4"],
Cell[81998, 2183, 296, 6, 42, "Output",ExpressionUUID->"0b022ddd-a0f2-4fa2-b8c0-f38055f9cebd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82331, 2194, 1454, 40, 158, "Input",ExpressionUUID->"a8869a9e-aadc-4019-be8d-d658a7d89962"],
Cell[83788, 2236, 1581, 44, 70, "Output",ExpressionUUID->"6c285c3b-ce77-4493-9cea-82a773ca270f"],
Cell[85372, 2282, 507, 11, 70, "Output",ExpressionUUID->"7a08d139-ef5e-4743-993d-00345a366fd7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[85928, 2299, 174, 3, 65, "Section",ExpressionUUID->"25265eec-160b-47d9-8387-8cfa0ab0414f"],
Cell[86105, 2304, 3073, 87, 255, "Input",ExpressionUUID->"b199a1f3-334c-4542-9498-849a96567973"],
Cell[CellGroupData[{
Cell[89203, 2395, 1007, 25, 116, "Input",ExpressionUUID->"03d94bc0-f308-44d6-90f6-f33bfa8dea34"],
Cell[90213, 2422, 486, 12, 52, "Output",ExpressionUUID->"e51dfb1f-d9c7-4467-b56e-35f44a249e2c"],
Cell[90702, 2436, 357, 7, 42, "Output",ExpressionUUID->"a9628717-6642-45d7-93d5-abe9aa0099ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91096, 2448, 1562, 41, 90, "Input",ExpressionUUID->"e68e003f-5313-4947-ba46-93bcafd0a18b"],
Cell[92661, 2491, 3933, 117, 106, "Output",ExpressionUUID->"c541e077-7a46-40f5-af21-6de3118976ca"],
Cell[96597, 2610, 3947, 115, 106, "Output",ExpressionUUID->"5324b390-db33-44f8-a608-9e2ad10d9e26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100581, 2730, 912, 21, 142, "Input",ExpressionUUID->"d776cc5b-660e-426f-88c2-532899eee5a2"],
Cell[101496, 2753, 712, 21, 68, "Output",ExpressionUUID->"e24ec77a-a50c-4853-952d-15589ec6e618"],
Cell[102211, 2776, 1943, 59, 70, "Output",ExpressionUUID->"8fd415bb-4ecb-44e6-97f4-cd006cd9cacd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104191, 2840, 2844, 71, 220, "Input",ExpressionUUID->"81b38675-dced-494b-ae73-0a6bf423cefc"],
Cell[107038, 2913, 775, 16, 70, "Output",ExpressionUUID->"91ae2dfb-14fa-4212-9d86-559292193439"],
Cell[107816, 2931, 1889, 48, 70, "Output",ExpressionUUID->"a7dd5598-d801-452a-aa2a-f8fb5719704c"]
}, Open  ]],
Cell[109720, 2982, 338, 8, 37, "Input",ExpressionUUID->"08de6e5f-c8df-4cf1-938c-cee6cf5ff126"],
Cell[CellGroupData[{
Cell[110083, 2994, 2027, 55, 71, "Input",ExpressionUUID->"5518958b-e634-43a9-b546-5854f3aef5e2"],
Cell[112113, 3051, 247, 4, 70, "Output",ExpressionUUID->"552109d8-4796-48ec-9568-3160c7942b31"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[112409, 3061, 244, 4, 65, "Section",ExpressionUUID->"7685156a-9502-485e-bc19-7a12603fe77f"],
Cell[CellGroupData[{
Cell[112678, 3069, 2049, 54, 90, "Input",ExpressionUUID->"58ec0087-6d37-430e-98cf-746c3983c5d9"],
Cell[114730, 3125, 4103, 100, 69, "Output",ExpressionUUID->"31bdfb9e-900c-4501-b79a-e2c1d4735fc7"],
Cell[118836, 3227, 4116, 100, 69, "Output",ExpressionUUID->"a9c22040-40eb-4561-80e0-8e12e83abef1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122989, 3332, 2568, 67, 90, "Input",ExpressionUUID->"9dbd40e3-d0a7-40bc-af75-d7d6de4e5340"],
Cell[125560, 3401, 1503, 37, 67, "Output",ExpressionUUID->"3ed8e50e-23eb-4583-ac91-34e316562df9"],
Cell[127066, 3440, 1510, 37, 69, "Output",ExpressionUUID->"0248c0ec-eb70-437f-9fe4-cc191a3d2193"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128613, 3482, 990, 24, 64, "Input",ExpressionUUID->"ab3a76bc-4637-474e-9fea-e967b7bd4bda"],
Cell[129606, 3508, 1494, 38, 68, "Output",ExpressionUUID->"b96318cf-7162-4123-a617-ac25e9c23b8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131137, 3551, 2820, 73, 71, "Input",ExpressionUUID->"b20d5812-0935-4b99-9a20-af9c1f350794"],
Cell[133960, 3626, 1250, 32, 67, "Output",ExpressionUUID->"bc508aeb-51bd-4544-ac62-027f84018a64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135247, 3663, 2856, 75, 102, "Input",ExpressionUUID->"004c1d1f-58d3-4e21-8703-b43263cc4449"],
Cell[138106, 3740, 561, 9, 42, "Output",ExpressionUUID->"049d3db3-e137-4ae7-9750-7b0f6812e0e2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[138716, 3755, 177, 3, 65, "Section",ExpressionUUID->"63b52513-bb28-4c60-bcb9-65b09eb24e7f"],
Cell[CellGroupData[{
Cell[138918, 3762, 3288, 92, 116, "Input",ExpressionUUID->"ffed0b28-13ba-4acd-92c9-386bcb51f69e"],
Cell[142209, 3856, 2360, 55, 69, "Output",ExpressionUUID->"330c2472-d298-4d88-ae22-baa7edf4ff52"],
Cell[144572, 3913, 2178, 50, 67, "Output",ExpressionUUID->"20733ce2-a00c-4aca-a21b-d03eb73c061f"],
Cell[146753, 3965, 1198, 25, 42, "Output",ExpressionUUID->"db3c0841-e8e0-4619-a77a-f6eb9834eb96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147988, 3995, 6125, 161, 282, "Input",ExpressionUUID->"58308630-958f-4fbd-88ff-8a9214db59c4"],
Cell[154116, 4158, 1763, 48, 82, "Output",ExpressionUUID->"b94ccf9d-cf29-48c9-97f3-961b33c9cb37"],
Cell[155882, 4208, 3474, 94, 88, "Output",ExpressionUUID->"002243d2-92b4-4b62-b966-3a0739137cb4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[159405, 4308, 235, 4, 65, "Section",ExpressionUUID->"87861389-68a6-48a5-9d18-d0063a9a2feb"],
Cell[CellGroupData[{
Cell[159665, 4316, 1611, 39, 90, "Input",ExpressionUUID->"25eafbae-e458-41b3-8f4a-383145936054"],
Cell[161279, 4357, 6632, 162, 63, "Output",ExpressionUUID->"321b0762-3d6b-4a4e-a575-e320d26de248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167948, 4524, 12245, 314, 454, "Input",ExpressionUUID->"605dcd28-01f2-433f-92da-b35e917b7d06"],
Cell[180196, 4840, 633, 12, 61, "Output",ExpressionUUID->"d644a469-2c00-448b-a8b1-b1e2a332c247"],
Cell[180832, 4854, 1229, 31, 90, "Output",ExpressionUUID->"1687973d-c2ef-43a0-8dad-ccbbe2fd3674"],
Cell[182064, 4887, 1774, 48, 93, "Output",ExpressionUUID->"03d16977-6711-4432-9fcd-c3eeb24072e2"],
Cell[183841, 4937, 1886, 50, 119, "Output",ExpressionUUID->"a01681d4-aa29-4bc4-afc1-f0d3ecfcb4c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185764, 4992, 3341, 77, 121, "Input",ExpressionUUID->"72bcd2eb-92cd-4c2b-8551-61ee1faba4ce"],
Cell[189108, 5071, 1346, 26, 70, "Output",ExpressionUUID->"9a1b710b-b3f1-408c-8cb0-0291f8d08307"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190491, 5102, 5662, 135, 228, "Input",ExpressionUUID->"3e3ecdad-303d-434f-9796-eaf7ebbb6773"],
Cell[196156, 5239, 951, 23, 70, "Output",ExpressionUUID->"7e9dd6db-dd39-4360-aae5-7d6efea5a4ba"],
Cell[197110, 5264, 718, 15, 70, "Output",ExpressionUUID->"fea29a7e-a36c-4dba-945f-69429a557782"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197865, 5284, 1061, 29, 75, "Input",ExpressionUUID->"67a2876a-f9ab-4457-9bf2-0a5dd74919e5"],
Cell[198929, 5315, 4150, 120, 70, "Output",ExpressionUUID->"30ec4df5-785b-44ce-a3a2-c69e635365b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203116, 5440, 2620, 73, 159, "Input",ExpressionUUID->"31870c69-715b-4431-ab63-abf28ff2f2c7"],
Cell[205739, 5515, 910, 23, 70, "Output",ExpressionUUID->"18269e78-8f62-42f1-a277-39c28164b6ea"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[206698, 5544, 279, 4, 65, "Section",ExpressionUUID->"5b819c66-de88-40f9-94ea-2b7b73fc7897"],
Cell[CellGroupData[{
Cell[207002, 5552, 1730, 43, 139, "Input",ExpressionUUID->"4ca21be1-83cf-445f-afab-6f56ef3b6238"],
Cell[208735, 5597, 1436, 36, 45, "Output",ExpressionUUID->"d22a109d-1655-4d95-95ba-f7fb4ba02bbb"],
Cell[210174, 5635, 1135, 26, 45, "Output",ExpressionUUID->"d34eda9d-3860-4d55-a2c0-fe3e55fbd3e5"],
Cell[211312, 5663, 859, 18, 42, "Output",ExpressionUUID->"62ea1cbd-7bd7-4538-96dc-e9663809c838"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212208, 5686, 4424, 119, 221, "Input",ExpressionUUID->"9610ae58-17c9-4f79-81ed-6f6084e56a31"],
Cell[216635, 5807, 2715, 81, 77, "Output",ExpressionUUID->"ebc866ea-672d-4054-be6a-fb3d77e98bc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219387, 5893, 4467, 116, 159, "Input",ExpressionUUID->"b6af78ae-864f-459a-b34a-b8c78d89eb52"],
Cell[223857, 6011, 3487, 91, 79, "Output",ExpressionUUID->"dc1dffb8-5065-466e-90f3-227750b30b06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227381, 6107, 2740, 73, 90, "Input",ExpressionUUID->"fa375f26-e35d-47ed-81c9-f8bc59dcc98e"],
Cell[230124, 6182, 3524, 102, 72, "Output",ExpressionUUID->"261948ea-74e3-4670-bc5c-5826ea447f99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233685, 6289, 953, 23, 64, "Input",ExpressionUUID->"668f2032-1387-4835-993e-61cda46ebaab"],
Cell[234641, 6314, 936, 23, 70, "Output",ExpressionUUID->"0cdbd7de-d37b-438c-bcf2-1b37c2682d55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235614, 6342, 2509, 68, 144, "Input",ExpressionUUID->"306f2f49-e9f1-4a57-9cb6-7e83df56d3c1"],
Cell[238126, 6412, 849, 20, 70, "Output",ExpressionUUID->"46e5ed99-6ac6-4b95-94d3-b3495ac84c2c"],
Cell[238978, 6434, 637, 12, 70, "Output",ExpressionUUID->"80a00b74-3f5e-4190-b2a7-4cd295bd1866"],
Cell[239618, 6448, 749, 16, 70, "Output",ExpressionUUID->"01a203a7-ac60-4a21-b027-88f12bf10c9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240404, 6469, 1748, 46, 117, "Input",ExpressionUUID->"9d52883b-f36c-458b-b829-6157f9775d1d"],
Cell[242155, 6517, 7055, 190, 70, "Output",ExpressionUUID->"960ed2d5-e71f-4548-9a34-0f77a3f9cbed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249247, 6712, 784, 25, 37, "Input",ExpressionUUID->"275c86fc-2801-47d6-a9b2-26ba9105707b"],
Cell[250034, 6739, 923, 26, 70, "Output",ExpressionUUID->"28476f13-8072-4d03-9369-a48d9823c48b"]
}, Open  ]],
Cell[250972, 6768, 1269, 40, 75, "Input",ExpressionUUID->"13030f5e-46b3-4a92-a3f7-eceec43a281a"]
}, Closed]],
Cell[CellGroupData[{
Cell[252278, 6813, 174, 3, 65, "Section",ExpressionUUID->"6478f18a-954e-4ae9-bc84-2febb6b52087"],
Cell[252455, 6818, 1047, 23, 64, "Input",ExpressionUUID->"3dd05f46-001d-4205-8bfa-986ea5061dc4"],
Cell[CellGroupData[{
Cell[253527, 6845, 2882, 74, 150, "Input",ExpressionUUID->"d08af839-55d6-489e-baca-273a167855bb"],
Cell[256412, 6921, 2200, 72, 73, "Output",ExpressionUUID->"c92e53a7-6992-4ec7-a20e-bde597b43d19"]
}, Open  ]],
Cell[258627, 6996, 853, 17, 64, "Input",ExpressionUUID->"036eedac-fe86-4a47-af70-d7a36e9a7106"],
Cell[CellGroupData[{
Cell[259505, 7017, 2317, 59, 90, "Input",ExpressionUUID->"ebafa545-915a-40e7-9580-bdddb2293d3b"],
Cell[261825, 7078, 692, 23, 88, "Output",ExpressionUUID->"d848ac43-515f-4b41-bd30-fac6b91d557b"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

